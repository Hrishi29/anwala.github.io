<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"><script type="text/javascript">(window.NREUM||(NREUM={})).loader_config={xpid:"UgcBUlRRGwEBUVZVBwUC"};window.NREUM||(NREUM={}),__nr_require=function(t,n,e){function r(e){if(!n[e]){var o=n[e]={exports:{}};t[e][0].call(o.exports,function(n){var o=t[e][1][n];return r(o||n)},o,o.exports)}return n[e].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<e.length;o++)r(e[o]);return r}({1:[function(t,n,e){function r(t){try{s.console&&console.log(t)}catch(n){}}var o,i=t("ee"),a=t(15),s={};try{o=localStorage.getItem("__nr_flags").split(","),console&&"function"==typeof console.log&&(s.console=!0,o.indexOf("dev")!==-1&&(s.dev=!0),o.indexOf("nr_dev")!==-1&&(s.nrDev=!0))}catch(c){}s.nrDev&&i.on("internal-error",function(t){r(t.stack)}),s.dev&&i.on("fn-err",function(t,n,e){r(e.stack)}),s.dev&&(r("NR AGENT IN DEVELOPMENT MODE"),r("flags: "+a(s,function(t,n){return t}).join(", ")))},{}],2:[function(t,n,e){function r(t,n,e,r,s){try{p?p-=1:o(s||new UncaughtException(t,n,e),!0)}catch(f){try{i("ierr",[f,c.now(),!0])}catch(d){}}return"function"==typeof u&&u.apply(this,a(arguments))}function UncaughtException(t,n,e){this.message=t||"Uncaught error with no additional information",this.sourceURL=n,this.line=e}function o(t,n){var e=n?null:c.now();i("err",[t,e])}var i=t("handle"),a=t(16),s=t("ee"),c=t("loader"),f=t("gos"),u=window.onerror,d=!1,l="nr@seenError",p=0;c.features.err=!0,t(1),window.onerror=r;try{throw new Error}catch(h){"stack"in h&&(t(8),t(7),"addEventListener"in window&&t(5),c.xhrWrappable&&t(9),d=!0)}s.on("fn-start",function(t,n,e){d&&(p+=1)}),s.on("fn-err",function(t,n,e){d&&!e[l]&&(f(e,l,function(){return!0}),this.thrown=!0,o(e))}),s.on("fn-end",function(){d&&!this.thrown&&p>0&&(p-=1)}),s.on("internal-error",function(t){i("ierr",[t,c.now(),!0])})},{}],3:[function(t,n,e){t("loader").features.ins=!0},{}],4:[function(t,n,e){function r(t){}if(window.performance&&window.performance.timing&&window.performance.getEntriesByType){var o=t("ee"),i=t("handle"),a=t(8),s=t(7),c="learResourceTimings",f="addEventListener",u="resourcetimingbufferfull",d="bstResource",l="resource",p="-start",h="-end",m="fn"+p,w="fn"+h,v="bstTimer",y="pushState",g=t("loader");g.features.stn=!0,t(6);var b=NREUM.o.EV;o.on(m,function(t,n){var e=t[0];e instanceof b&&(this.bstStart=g.now())}),o.on(w,function(t,n){var e=t[0];e instanceof b&&i("bst",[e,n,this.bstStart,g.now()])}),a.on(m,function(t,n,e){this.bstStart=g.now(),this.bstType=e}),a.on(w,function(t,n){i(v,[n,this.bstStart,g.now(),this.bstType])}),s.on(m,function(){this.bstStart=g.now()}),s.on(w,function(t,n){i(v,[n,this.bstStart,g.now(),"requestAnimationFrame"])}),o.on(y+p,function(t){this.time=g.now(),this.startPath=location.pathname+location.hash}),o.on(y+h,function(t){i("bstHist",[location.pathname+location.hash,this.startPath,this.time])}),f in window.performance&&(window.performance["c"+c]?window.performance[f](u,function(t){i(d,[window.performance.getEntriesByType(l)]),window.performance["c"+c]()},!1):window.performance[f]("webkit"+u,function(t){i(d,[window.performance.getEntriesByType(l)]),window.performance["webkitC"+c]()},!1)),document[f]("scroll",r,{passive:!0}),document[f]("keypress",r,!1),document[f]("click",r,!1)}},{}],5:[function(t,n,e){function r(t){for(var n=t;n&&!n.hasOwnProperty(u);)n=Object.getPrototypeOf(n);n&&o(n)}function o(t){s.inPlace(t,[u,d],"-",i)}function i(t,n){return t[1]}var a=t("ee").get("events"),s=t(18)(a,!0),c=t("gos"),f=XMLHttpRequest,u="addEventListener",d="removeEventListener";n.exports=a,"getPrototypeOf"in Object?(r(document),r(window),r(f.prototype)):f.prototype.hasOwnProperty(u)&&(o(window),o(f.prototype)),a.on(u+"-start",function(t,n){var e=t[1],r=c(e,"nr@wrapped",function(){function t(){if("function"==typeof e.handleEvent)return e.handleEvent.apply(e,arguments)}var n={object:t,"function":e}[typeof e];return n?s(n,"fn-",null,n.name||"anonymous"):e});this.wrapped=t[1]=r}),a.on(d+"-start",function(t){t[1]=this.wrapped||t[1]})},{}],6:[function(t,n,e){var r=t("ee").get("history"),o=t(18)(r);n.exports=r,o.inPlace(window.history,["pushState","replaceState"],"-")},{}],7:[function(t,n,e){var r=t("ee").get("raf"),o=t(18)(r),i="equestAnimationFrame";n.exports=r,o.inPlace(window,["r"+i,"mozR"+i,"webkitR"+i,"msR"+i],"raf-"),r.on("raf-start",function(t){t[0]=o(t[0],"fn-")})},{}],8:[function(t,n,e){function r(t,n,e){t[0]=a(t[0],"fn-",null,e)}function o(t,n,e){this.method=e,this.timerDuration=isNaN(t[1])?0:+t[1],t[0]=a(t[0],"fn-",this,e)}var i=t("ee").get("timer"),a=t(18)(i),s="setTimeout",c="setInterval",f="clearTimeout",u="-start",d="-";n.exports=i,a.inPlace(window,[s,"setImmediate"],s+d),a.inPlace(window,[c],c+d),a.inPlace(window,[f,"clearImmediate"],f+d),i.on(c+u,r),i.on(s+u,o)},{}],9:[function(t,n,e){function r(t,n){d.inPlace(n,["onreadystatechange"],"fn-",s)}function o(){var t=this,n=u.context(t);t.readyState>3&&!n.resolved&&(n.resolved=!0,u.emit("xhr-resolved",[],t)),d.inPlace(t,y,"fn-",s)}function i(t){g.push(t),h&&(x?x.then(a):w?w(a):(E=-E,O.data=E))}function a(){for(var t=0;t<g.length;t++)r([],g[t]);g.length&&(g=[])}function s(t,n){return n}function c(t,n){for(var e in t)n[e]=t[e];return n}t(5);var f=t("ee"),u=f.get("xhr"),d=t(18)(u),l=NREUM.o,p=l.XHR,h=l.MO,m=l.PR,w=l.SI,v="readystatechange",y=["onload","onerror","onabort","onloadstart","onloadend","onprogress","ontimeout"],g=[];n.exports=u;var b=window.XMLHttpRequest=function(t){var n=new p(t);try{u.emit("new-xhr",[n],n),n.addEventListener(v,o,!1)}catch(e){try{u.emit("internal-error",[e])}catch(r){}}return n};if(c(p,b),b.prototype=p.prototype,d.inPlace(b.prototype,["open","send"],"-xhr-",s),u.on("send-xhr-start",function(t,n){r(t,n),i(n)}),u.on("open-xhr-start",r),h){var x=m&&m.resolve();if(!w&&!m){var E=1,O=document.createTextNode(E);new h(a).observe(O,{characterData:!0})}}else f.on("fn-end",function(t){t[0]&&t[0].type===v||a()})},{}],10:[function(t,n,e){function r(t){var n=this.params,e=this.metrics;if(!this.ended){this.ended=!0;for(var r=0;r<d;r++)t.removeEventListener(u[r],this.listener,!1);if(!n.aborted){if(e.duration=a.now()-this.startTime,4===t.readyState){n.status=t.status;var i=o(t,this.lastSize);if(i&&(e.rxSize=i),this.sameOrigin){var c=t.getResponseHeader("X-NewRelic-App-Data");c&&(n.cat=c.split(", ").pop())}}else n.status=0;e.cbTime=this.cbTime,f.emit("xhr-done",[t],t),s("xhr",[n,e,this.startTime])}}}function o(t,n){var e=t.responseType;if("json"===e&&null!==n)return n;var r="arraybuffer"===e||"blob"===e||"json"===e?t.response:t.responseText;return h(r)}function i(t,n){var e=c(n),r=t.params;r.host=e.hostname+":"+e.port,r.pathname=e.pathname,t.sameOrigin=e.sameOrigin}var a=t("loader");if(a.xhrWrappable){var s=t("handle"),c=t(11),f=t("ee"),u=["load","error","abort","timeout"],d=u.length,l=t("id"),p=t(14),h=t(13),m=window.XMLHttpRequest;a.features.xhr=!0,t(9),f.on("new-xhr",function(t){var n=this;n.totalCbs=0,n.called=0,n.cbTime=0,n.end=r,n.ended=!1,n.xhrGuids={},n.lastSize=null,p&&(p>34||p<10)||window.opera||t.addEventListener("progress",function(t){n.lastSize=t.loaded},!1)}),f.on("open-xhr-start",function(t){this.params={method:t[0]},i(this,t[1]),this.metrics={}}),f.on("open-xhr-end",function(t,n){"loader_config"in NREUM&&"xpid"in NREUM.loader_config&&this.sameOrigin&&n.setRequestHeader("X-NewRelic-ID",NREUM.loader_config.xpid)}),f.on("send-xhr-start",function(t,n){var e=this.metrics,r=t[0],o=this;if(e&&r){var i=h(r);i&&(e.txSize=i)}this.startTime=a.now(),this.listener=function(t){try{"abort"===t.type&&(o.params.aborted=!0),("load"!==t.type||o.called===o.totalCbs&&(o.onloadCalled||"function"!=typeof n.onload))&&o.end(n)}catch(e){try{f.emit("internal-error",[e])}catch(r){}}};for(var s=0;s<d;s++)n.addEventListener(u[s],this.listener,!1)}),f.on("xhr-cb-time",function(t,n,e){this.cbTime+=t,n?this.onloadCalled=!0:this.called+=1,this.called!==this.totalCbs||!this.onloadCalled&&"function"==typeof e.onload||this.end(e)}),f.on("xhr-load-added",function(t,n){var e=""+l(t)+!!n;this.xhrGuids&&!this.xhrGuids[e]&&(this.xhrGuids[e]=!0,this.totalCbs+=1)}),f.on("xhr-load-removed",function(t,n){var e=""+l(t)+!!n;this.xhrGuids&&this.xhrGuids[e]&&(delete this.xhrGuids[e],this.totalCbs-=1)}),f.on("addEventListener-end",function(t,n){n instanceof m&&"load"===t[0]&&f.emit("xhr-load-added",[t[1],t[2]],n)}),f.on("removeEventListener-end",function(t,n){n instanceof m&&"load"===t[0]&&f.emit("xhr-load-removed",[t[1],t[2]],n)}),f.on("fn-start",function(t,n,e){n instanceof m&&("onload"===e&&(this.onload=!0),("load"===(t[0]&&t[0].type)||this.onload)&&(this.xhrCbStart=a.now()))}),f.on("fn-end",function(t,n){this.xhrCbStart&&f.emit("xhr-cb-time",[a.now()-this.xhrCbStart,this.onload,n],n)})}},{}],11:[function(t,n,e){n.exports=function(t){var n=document.createElement("a"),e=window.location,r={};n.href=t,r.port=n.port;var o=n.href.split("://");!r.port&&o[1]&&(r.port=o[1].split("/")[0].split("@").pop().split(":")[1]),r.port&&"0"!==r.port||(r.port="https"===o[0]?"443":"80"),r.hostname=n.hostname||e.hostname,r.pathname=n.pathname,r.protocol=o[0],"/"!==r.pathname.charAt(0)&&(r.pathname="/"+r.pathname);var i=!n.protocol||":"===n.protocol||n.protocol===e.protocol,a=n.hostname===document.domain&&n.port===e.port;return r.sameOrigin=i&&(!n.hostname||a),r}},{}],12:[function(t,n,e){function r(){}function o(t,n,e){return function(){return i(t,[f.now()].concat(s(arguments)),n?null:this,e),n?void 0:this}}var i=t("handle"),a=t(15),s=t(16),c=t("ee").get("tracer"),f=t("loader"),u=NREUM;"undefined"==typeof window.newrelic&&(newrelic=u);var d=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],l="api-",p=l+"ixn-";a(d,function(t,n){u[n]=o(l+n,!0,"api")}),u.addPageAction=o(l+"addPageAction",!0),u.setCurrentRouteName=o(l+"routeName",!0),n.exports=newrelic,u.interaction=function(){return(new r).get()};var h=r.prototype={createTracer:function(t,n){var e={},r=this,o="function"==typeof n;return i(p+"tracer",[f.now(),t,e],r),function(){if(c.emit((o?"":"no-")+"fn-start",[f.now(),r,o],e),o)try{return n.apply(this,arguments)}catch(t){throw c.emit("fn-err",[arguments,this,t],e),t}finally{c.emit("fn-end",[f.now()],e)}}}};a("setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(t,n){h[n]=o(p+n)}),newrelic.noticeError=function(t){"string"==typeof t&&(t=new Error(t)),i("err",[t,f.now()])}},{}],13:[function(t,n,e){n.exports=function(t){if("string"==typeof t&&t.length)return t.length;if("object"==typeof t){if("undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer&&t.byteLength)return t.byteLength;if("undefined"!=typeof Blob&&t instanceof Blob&&t.size)return t.size;if(!("undefined"!=typeof FormData&&t instanceof FormData))try{return JSON.stringify(t).length}catch(n){return}}}},{}],14:[function(t,n,e){var r=0,o=navigator.userAgent.match(/Firefox[\/\s](\d+\.\d+)/);o&&(r=+o[1]),n.exports=r},{}],15:[function(t,n,e){function r(t,n){var e=[],r="",i=0;for(r in t)o.call(t,r)&&(e[i]=n(r,t[r]),i+=1);return e}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],16:[function(t,n,e){function r(t,n,e){n||(n=0),"undefined"==typeof e&&(e=t?t.length:0);for(var r=-1,o=e-n||0,i=Array(o<0?0:o);++r<o;)i[r]=t[n+r];return i}n.exports=r},{}],17:[function(t,n,e){n.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],18:[function(t,n,e){function r(t){return!(t&&t instanceof Function&&t.apply&&!t[a])}var o=t("ee"),i=t(16),a="nr@original",s=Object.prototype.hasOwnProperty,c=!1;n.exports=function(t,n){function e(t,n,e,o){function nrWrapper(){var r,a,s,c;try{a=this,r=i(arguments),s="function"==typeof e?e(r,a):e||{}}catch(f){l([f,"",[r,a,o],s])}u(n+"start",[r,a,o],s);try{return c=t.apply(a,r)}catch(d){throw u(n+"err",[r,a,d],s),d}finally{u(n+"end",[r,a,c],s)}}return r(t)?t:(n||(n=""),nrWrapper[a]=t,d(t,nrWrapper),nrWrapper)}function f(t,n,o,i){o||(o="");var a,s,c,f="-"===o.charAt(0);for(c=0;c<n.length;c++)s=n[c],a=t[s],r(a)||(t[s]=e(a,f?s+o:o,i,s))}function u(e,r,o){if(!c||n){var i=c;c=!0;try{t.emit(e,r,o,n)}catch(a){l([a,e,r,o])}c=i}}function d(t,n){if(Object.defineProperty&&Object.keys)try{var e=Object.keys(t);return e.forEach(function(e){Object.defineProperty(n,e,{get:function(){return t[e]},set:function(n){return t[e]=n,n}})}),n}catch(r){l([r])}for(var o in t)s.call(t,o)&&(n[o]=t[o]);return n}function l(n){try{t.emit("internal-error",n)}catch(e){}}return t||(t=o),e.inPlace=f,e.flag=a,e}},{}],ee:[function(t,n,e){function r(){}function o(t){function n(t){return t&&t instanceof r?t:t?c(t,s,i):i()}function e(e,r,o,i){if(!l.aborted||i){t&&t(e,r,o);for(var a=n(o),s=h(e),c=s.length,f=0;f<c;f++)s[f].apply(a,r);var d=u[y[e]];return d&&d.push([g,e,r,a]),a}}function p(t,n){v[t]=h(t).concat(n)}function h(t){return v[t]||[]}function m(t){return d[t]=d[t]||o(e)}function w(t,n){f(t,function(t,e){n=n||"feature",y[e]=n,n in u||(u[n]=[])})}var v={},y={},g={on:p,emit:e,get:m,listeners:h,context:n,buffer:w,abort:a,aborted:!1};return g}function i(){return new r}function a(){(u.api||u.feature)&&(l.aborted=!0,u=l.backlog={})}var s="nr@context",c=t("gos"),f=t(15),u={},d={},l=n.exports=o();l.backlog=u},{}],gos:[function(t,n,e){function r(t,n,e){if(o.call(t,n))return t[n];var r=e();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(t,n,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return t[n]=r,r}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],handle:[function(t,n,e){function r(t,n,e,r){o.buffer([t],r),o.emit(t,n,e)}var o=t("ee").get("handle");n.exports=r,r.ee=o},{}],id:[function(t,n,e){function r(t){var n=typeof t;return!t||"object"!==n&&"function"!==n?-1:t===window?0:a(t,i,function(){return o++})}var o=1,i="nr@id",a=t("gos");n.exports=r},{}],loader:[function(t,n,e){function r(){if(!x++){var t=b.info=NREUM.info,n=l.getElementsByTagName("script")[0];if(setTimeout(u.abort,3e4),!(t&&t.licenseKey&&t.applicationID&&n))return u.abort();f(y,function(n,e){t[n]||(t[n]=e)}),c("mark",["onload",a()+b.offset],null,"api");var e=l.createElement("script");e.src="https://"+t.agent,n.parentNode.insertBefore(e,n)}}function o(){"complete"===l.readyState&&i()}function i(){c("mark",["domContent",a()+b.offset],null,"api")}function a(){return E.exists&&performance.now?Math.round(performance.now()):(s=Math.max((new Date).getTime(),s))-b.offset}var s=(new Date).getTime(),c=t("handle"),f=t(15),u=t("ee"),d=window,l=d.document,p="addEventListener",h="attachEvent",m=d.XMLHttpRequest,w=m&&m.prototype;NREUM.o={ST:setTimeout,SI:d.setImmediate,CT:clearTimeout,XHR:m,REQ:d.Request,EV:d.Event,PR:d.Promise,MO:d.MutationObserver};var v=""+location,y={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1071.min.js"},g=m&&w&&w[p]&&!/CriOS/.test(navigator.userAgent),b=n.exports={offset:s,now:a,origin:v,features:{},xhrWrappable:g};t(12),l[p]?(l[p]("DOMContentLoaded",i,!1),d[p]("load",r,!1)):(l[h]("onreadystatechange",o),d[h]("onload",r)),c("mark",["firstbyte",s],null,"api");var x=0,E=t(17)},{}]},{},["loader",2,10,4,3]);</script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <meta name="description" content="Let People Know the Trump Administration is Taking Action on Criminal Aliens">
    <meta name="author" content="Federation for American Immigration Reform">
    	    	    	<link rel="shortcut icon" href="https://p2a-images.s3.amazonaws.com/production/customers/565/tFHUfuBMFYYbIRg7TxOb15028064981123.png">
	    
	    <title>Let People Know the Trump Administration is Taking Action on Criminal Aliens</title>
    
    <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-K5JN975');</script>
<!-- End Google Tag Manager -->
    <script type="text/javascript">
    if (!window.P2A) {
        window.P2A = {};
    }
    if (!window.P2A.CampaignData) {
        window.P2A.CampaignData = {};
    }
            window.P2A.CampaignData.campaignId = 18755;
    
    
            window.P2A.CampaignData.domain = 'p2a.co';
    </script>
	<meta name="twitter:card" content="summary">

<meta name="twitter:title" content="Let People Know the Trump Administration is Taking Action on Criminal Aliens">

	<meta name="twitter:site" content="@FAIRImmigration">
	<meta name="twitter:creator" content="@FAIRImmigration">

	<meta name="twitter:description" content="Enter your information to take action now!">

	<meta property="twitter:image:src" content="http://cdn.p2a.co/PnUyOlGcZk1495729951dzDvjA0utX?v=1719502018">

	<meta property="fb:app_id" content="1427167970874264" />

	<meta property="og:title" content="Let People Know the Trump Administration is Taking Action on Criminal Aliens" />

<meta property="og:site_name" content="Federation for American Immigration Reform" />

    <meta property="og:description" content="President Trump is almost done with putting in place zero tolerance for criminal aliens. learn more here.">

        <meta property="og:image" content="http://cdn.p2a.co/PnUyOlGcZk1495729951dzDvjA0utX">

		<meta property="og:url" content="http://p2a.co/2XxyMpX">

    <!-- Bootstrap core CSS -->
    <link media="all" type="text/css" rel="stylesheet" href="https://d2ab4fmh03vt6m.cloudfront.net/css/bootstrap.css?v=1518795536">

    <link media="all" type="text/css" rel="stylesheet" href="https://d2ab4fmh03vt6m.cloudfront.net/css/apps.css?v=1518795536">

    <link media="all" type="text/css" rel="stylesheet" href="https://d2ab4fmh03vt6m.cloudfront.net/css/social-share/social-share.css?v=1518795536">


    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="http://p2a.co/js/apps/html5shiv.js"></script>

      <script src="http://p2a.co/js/apps/respond.min.js"></script>

    <![endif]-->

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>

    <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>

    <script src="https://d2ab4fmh03vt6m.cloudfront.net/js/apps/placeholders.js?v=1518795536"></script>


    <!--   TYPEKIT EMBED -->
    	<script src="//use.typekit.net/svf7ydo.js"></script>

    <script type="text/javascript">try {
            Typekit.load();
        } catch (e) {
        }</script>
	<script src="https://d2ab4fmh03vt6m.cloudfront.net/js/helpers/helpers.js?v=1518795536"></script>


	<style type="text/css">
		#sitecontainer {
			color:#0B294F;
		}
    
		.action-container-default-template, label, .action-container-default-template #heading {
			color:#E8E8E8 !important;
		}
	</style>

	<script>
		$(document).ready(function(){
			$("#phone").keydown(function(event) {
				// Allow: backspace, delete, tab, escape, and enter
				if ( event.keyCode == 46 || event.keyCode == 8 || event.keyCode == 9 || event.keyCode == 27 || event.keyCode == 13 ||
					 // Allow: Ctrl and Cmd
					(event.ctrlKey === true || event.metaKey === true) ||
					 // Allow: home, end, left, right
					(event.keyCode >= 35 && event.keyCode <= 39)) {
						 // let it happen, don't do anything
						 return;
				}
				else {
					// Ensure that it is a number and stop the keypress
					if (event.shiftKey || (event.keyCode < 48 || event.keyCode > 57) && (event.keyCode < 96 || event.keyCode > 105 )) {
						event.preventDefault();
					}
				}
			});
		});
	</script>

	<link media="all" type="text/css" rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.css">

	<link media="all" type="text/css" rel="stylesheet" href="https://d2ab4fmh03vt6m.cloudfront.net/css/actioncenter.css?v=1518795536">


    <style type="text/css">
    	body {
	    	background-color:#055093;
    	}

    	.action-container-default-template #heading, #slider .heading {
	    	 background-color:#333333;
    	}
      .action-container-default-template .heading{
         background-color:#FFFFFF;
      }
    	.paper:before {
	    	border-color: #700000 #333333!important;
    	}
    	.action-container-default-template {
	    	 background-color:#333333;
    	}
    	/*.post-button {
             background-color:
        #D41600
        ;
                     color:
        #FFFFFF
        ;
    	}*/
    	.btn-bright, .actionsubmitbutton {
	    	background-color:#D41600;
	    	color:#FFFFFF;
    	}
    	.btn-bright:hover, .actionsubmitbutton:hover {
	    	background-color:#ff705a;
	    	color:#FFFFFF;
    	}
    	.title {
	    	background-color:#D41600;
	    	color:#FFFFFF;
    	}
    	.badge-add-message {
	    	background-color:#D41600;
	    	color:#FFFFFF;
	    	border-left:2px solid #700000;
			box-shadow:1px 1px 2px #700000;
    	}
    	.badge-sendto {
	    	background-color:#D41600;
	    	color:#FFFFFF;
	    	border-left:2px solid #700000;
			box-shadow:1px 1px 2px #700000;
    	}
    	.official-selected {
	    	background-color:#144E91;
	    	border-left:3px solid #78b2ff;
    	}
    	.active-action-icon {
	    	color:#D41600;
    	}

        #thankyou {
        }

    	.container-finish {
    		max-width:600px;
    	}
    	.applabel-complete {
	    	color:#000;
    	}
    	#signatures {
	    	padding:20px 5px 16px 5px;
	    	text-align:center;
    	}

        #signaturesContainer {
            display: inline;
        }

    	#signatureNum {
	    	font-family:'proxima-nova',sans-serif;
            font-size: 36px;
	    	display:inline;
	    	font-weight:bold;
    	}

    	#signatureLabel {
	    	font-family:'proxima-nova',sans-serif;
	    	display:inline;
	    	padding-left:5px;
    	}
    	.cookie-badge-not-you {
    		background-color:#D41600;
    		color:#FFFFFF;
    	}

    				#sitecontainer {
    			background-color:#FFFFFF;
    		}
    	
    	      .copyright {
        margin: 20px;
      }
      .copyright, .copyright a {
          color: #FFFFFF;
          font-size: 12px;
          text-align: center;
      }
      .copyright-link {
        text-decoration: underline;
        cursor: pointer;
      }
      .disclaimer {
        color:#FFFFFF;
        font-size: 12px;
        line-height: 100%;
        font-weight: normal;
        display: block;
      }

    </style>

    
    <script src="//cdnjs.cloudflare.com/ajax/libs/luminateExtend/1.6.0/luminateExtend.min.js"></script>

    <script type="text/javascript">
    		</script>

                <script type="text/javascript">
            $(function() {
    $('#heading h2').prepend('<img style="display: block; margin: 0px auto; max-width: 720px; width: 100%;" src="https://cdn.p2a.co/211682/ZpSTqxuEnP1501873599eh7XP7mE5y" alt="take action">');
});
    </script>
    
  </head>

	
<body class="has-social-share">
  <!-- Google Tag Manager (noscript) -->
<noscript>
  <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-K5JN975" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<!-- End Google Tag Manager (noscript) -->

  <script type="text/javascript">
  _bizo_data_partner_id = "9621";
</script>
<script type="text/javascript">
(function() {
  var s = document.getElementsByTagName("script")[0];
  var b = document.createElement("script");
  b.type = "text/javascript";
  b.async = true;
  b.src = (window.location.protocol === "https:" ? "https://sjs" : "http://js") + ".bizographics.com/insight.min.js";
  s.parentNode.insertBefore(b, s);
})();
</script>
<noscript>
  <img height="1" width="1" alt="" style="display:none;" src="//www.bizographics.com/collect/?pid=9621&fmt=gif" />
</noscript>
      <script src="https://d2ab4fmh03vt6m.cloudfront.net/js/app/campaigns/legcontact.js?v=1518795536"></script>


    <script type="text/javascript">
    if(typeof window.CampaignActionCenter != 'undefined') {
                                    window.CampaignActionCenter.fieldOptions['fieldsEmailFacebook'] = 1;
                            window.CampaignActionCenter.fieldOptions['fieldsTitleFacebook'] = 0;
                            window.CampaignActionCenter.fieldOptions['fieldsNameFacebook'] = 0;
                            window.CampaignActionCenter.fieldOptions['fieldsPhoneFacebook'] = 1;
                            window.CampaignActionCenter.fieldOptions['fieldsAddress1Facebook'] = 1;
                            window.CampaignActionCenter.fieldOptions['fieldsZip5Facebook'] = 1;
                            window.CampaignActionCenter.fieldOptions['fieldsCountryFacebook'] = 0;
                            window.CampaignActionCenter.fieldOptions['fieldsSubscribeSmsFacebook'] = 0;
                            window.CampaignActionCenter.fieldOptions['fieldsSubscribeEmailFacebook'] = 0;
                        }
</script>
    <script type="text/javascript">
if (!window.console) window.console = {};
if (!window.console.log) window.console.log = function () { };


</script>

<!-- start Mixpanel -->
  <script type="text/javascript">(function(f,b){if(!b.__SV){var a,e,i,g;window.mixpanel=b;b._i=[];b.init=function(a,e,d){function f(b,h){var a=h.split(".");2==a.length&&(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}var c=b;"undefined"!==typeof d?c=b[d]=[]:d="mixpanel";c.people=c.people||[];c.toString=function(b){var a="mixpanel";"mixpanel"!==d&&(a+="."+d);b||(a+=" (stub)");return a};c.people.toString=function(){return c.toString(1)+".people (stub)"};i="disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
for(g=0;g<i.length;g++)f(c,i[g]);b._i.push([a,e,d])};b.__SV=1.2;a=f.createElement("script");a.type="text/javascript";a.async=!0;a.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";e=f.getElementsByTagName("script")[0];e.parentNode.insertBefore(a,e)}})(document,window.mixpanel||[]);
mixpanel.init("dfc7aca7e5d828930e3a5a306e799d84");



</script><!-- end Mixpanel -->

<script type="text/javascript">
if (!mixpanel.time_event) mixpanel.time_event = function() {};
	CampaignActionCenter.MixPanel = {};
CampaignActionCenter.MixPanel.CreateEventMessage = function(eventMessage) {
	return 'UX ' + eventMessage;
};
CampaignActionCenter.MixPanel.GenerateParams = function(params) {
	var defaultParams = {
		advocateid: window.advocateid
	};
	params = $.extend({}, defaultParams, params);
	return params;
};
</script>


<link media="all" type="text/css" rel="stylesheet" href="https://d2ab4fmh03vt6m.cloudfront.net/css/app-facebook-preview.css?v=1518795536">


			<script src="//d3dy5gmtp8yhk7.cloudfront.net/3.0/pusher.min.js"></script>

		<script src="https://d2ab4fmh03vt6m.cloudfront.net/js/admin/pusher/p2apusher.js?v=1518795536"></script>

	


<style>
  html.ie-force-pseudo-refresh :before,
  html.ie-force-pseudo-refresh :after {
    content : none !important;
  }

  #facebook-actual-post-preview {
	  background-color: #F6F5F5;
	  border: 1px solid #CCC;
  }
  #facebook-actual-post-preview .preview-title {
	  color: #000;
	  font-size: 12px;
  }
  #facebook-actual-post-preview .preview-caption {
	display: none;
  }
  #facebook-actual-post-preview .preview-description {
	  color: #898989;
	  font-size: 12px;
  }
  #facebook-actual-post-preview .preview-image {

  }
  #facebook-actual-post-preview .preview-image img {
	  width: 75px;
  }
  #facebooksubmitbutton.emptyMsg, .facebooksubmitbutton.emptyMsg {
  	opacity: 0.65;
  }
  .red-border {
    border: 3px solid red;
  }


</style>
<script>
if (window.attachEvent && !window.addEventListener ) { // <-- Poor man's IE8 detection
	window.attachEvent( "onload", function() {
		var
		html = document.documentElement,
		clss = html.className;

		html.className = clss + " ie-force-pseudo-refresh";
		setTimeout( function(){ html.className = clss; }, 10 );
	});
};

CampaignActionCenter.HideVisibleInputs = function() {
			            var $visibleinputs = $('select:visible, input:visible, textarea:visible');
	    CampaignActionCenter.$hiddeninputs = [];
	$.each($visibleinputs, function() {
		var $me = $(this);
		var $parent = $me.parent();
		var formelementid = $me.attr('id');
		if (formelementid == 'fullname' || formelementid == 'prefix') {
			$parent = $parent.parent();
		}
		$parent.hide();
		CampaignActionCenter.$hiddeninputs.push($parent);
	});
};

CampaignActionCenter.HideCookieBadge = function() {
	$('#cookie-badge').hide();
};
CampaignActionCenter.ShowCookieBadge = function() {
	$('#cookie-badge').show();
};



CampaignActionCenter.facebook.UnselectLegislator = function(legid) {
    var $legcontainer = $('.official-selected[data-uniqueid="' + legid + '"]');
	$('.official-selected[data-uniqueid="' + legid + '"] > div > i').removeClass('fa-check').addClass('fa-times');
	$legcontainer.removeClass('official-selected').addClass('official-available');
	$('input[name="facebookchosenlegs[]"][value="' + legid +'"]', $legcontainer).prop('disabled', true);
	//$(tinymce.activeEditor.dom.select('.facebook-profile-link[data-legid="' + legid + '"]')).remove();
    $('.facebook-unselect-legislator', $legcontainer).hide();

    };
CampaignActionCenter.facebook.SelectLegislator = function(legid) {
	var $legcontainer = $('.official-available[data-uniqueid="' + legid + '"]');
	$('.official-available[data-uniqueid="' + legid + '"] > div > i').removeClass('fa-times').addClass('fa-check');
	$legcontainer.removeClass('official-available').addClass('official-selected');
	$('input[name="facebookchosenlegs[]"][value="' + legid +'"]', $legcontainer).prop('disabled', false);
    $('.facebook-unselect-legislator', $legcontainer).show();

    	//Add legislator to the content editor
	//tinymce.activeEditor.execCommand('mceInsertContent', false, ' <a href="http://www.facebook.com/' + $legcontainer.attr('data-fbid') + '" target="_blank" class="facebook-profile-link" data-legid="' + $legcontainer.attr('data-uniqueid') + '">@' + $legcontainer.attr('data-name') + '</a> ');
};
CampaignActionCenter.facebook.ShowPostsError = function() {
	var $acfb = $('#action-facebook');
	$acfb.addClass('action-completed');
	showerrormessage('One or more of your Facebook posts was unsuccessful.' +
					'<br />' +
					'<a id="facebookpostsreconnect" style="text-decoration: underline;">Click to reconnect <i class="fa fa-caret-right"></i></a>' +
					'<hr />' +
					'<div style="font-size: 14px; line-height: 130%;">If you chose to have your posts visible to "Only Me", make sure you select at least "Friends" visibility when you reconnect.' +
					'<br />' +
					'<a href="https://p2a-images.s3.amazonaws.com/p2a/helpers/action_center_permissions.png" target="_blank" style="text-decoration: underline;">See an example <i class="fa fa-caret-right"></i></a></div>');
	$('.action-image-status', $acfb).html('<div class="alert advocate-action-error facebookpostserror">Error!</div>').show();
};
CampaignActionCenter.facebook.Reconnect = function() {
	var formdata = new Object();
	formdata.campaignid = '18755';
	formdata.advocateid = window.advocateid;
	if (CampaignActionCenter.suid) {
		formdata.suid = CampaignActionCenter.suid;
	}
	formdata.domain = 'p2a.co';
	formdata.shorturl = '2XxyMpX';
	formdata.facebookappid = '1427167970874264';

	if (fbreconnectcall) {
		fbreconnectcall.abort();
	}
	var fbreconnectcalltoolong = window.setInterval(function() {
											//Kill the ajax call - the php will still run in the background, but when it returns, it won't do anything to conflict with what we are doing now
											fbreconnectcall.abort();
											//Mark this action as completed
											actionCompleted('facebook');
											window.clearInterval(fbreconnectcalltoolong);
											return false;
										}, 30000);
	var fbreconnectcall = $.ajax({
						type: 'post',
						url: '/ajax/actioncenter/facebook/reauthenticate',
						dataType: 'json',
						data: formdata,
						success: function(returndata){
							window.clearInterval(fbreconnectcalltoolong);
							$('#action-facebook').removeClass('action-completed').trigger('click');
															$('#facebooksubmitbutton, #steptwocontainer .facebooksubmitbutton').trigger('click');
													}
					});
	return false;
};

function ReadMore() {
	var facebookmessage = $('#facebook-message').val();
	$('.official-message').html(facebookmessage);
	$('.official-message').attr('style','max-height:none;');
}

CampaignActionCenter.suid = 0;


CampaignActionCenter.ShowConnections = function(data, type) {
	/*if (type == 'call') {
		var selector = '#actionexplanation>.legislators-called';
	} else {

	}*/
    if (type == 'call') {
        var $selector = $('.legislators-called', CampaignActionCenter.call.$previewcontainer);
    } else if (type == 'email') {
        var $selector = $('.legislators-called', CampaignActionCenter.email.$previewcontainer);
    }

    	$.each(data,function(i,v){
		var uniqueid = v['uniqueid'];
		var alreadyshown = false;

		//Check if we already have it listed - if so, don't display it again
		$('li', $selector).each(function(i,v) {
			if ($(this).data('uniqueid') == uniqueid ) {
				alreadyshown = true;
				return true;
			}
		});
		if (alreadyshown === true) {
			return true;
		}

		if(v['type'] == 'LEGISLATOR'){
			if(!v['party']){ v['party'] = ''; }
			if(!v['state']){ v['state'] = ''; }
			if(!v['title']){ v['title'] = ''; }
			if(!v['name_full']){ v['name_full'] = ''; }
			var datatoappend = '<li class="list-group-item" data-uniqueid="' + v['uniqueid'] + '"';
			datatoappend += '><div class="media"><div class="media-body">';

											if (v['photo']) {
					datatoappend += '<div class="img-circle leg-photo" style="background: url(\'/images/load?h=' + v['photo'] + '\') no-repeat center center;	background-size:cover; height: 40px; width:40px;"></div>';
				} else {
					datatoappend += '<div class="img-circle leg-photo" style="background-size:cover; height: 40px; width:40px;"></div>';
				}
			
			datatoappend += '<div class="leg-name leg-with-photo">' + v['title'] + ' ' + v['name_full'] + '</div>';

			
			datatoappend += '</div></div></li>';
			$selector.append(datatoappend);
		} else {
			if(v['type'] == 'OVERRIDE'){
				$selector.append('<li class="list-group-item" data-uniqueid="' + v['uniqueid'] + '"><div class="media"><div class="media-body"><div class="leg-name">' + v['name'] + '</div></div></div></li>');
			}
		}

		if (v['status'] && type == 'call') {
			CampaignActionCenter.call.UpdateStatus(v['uniqueid'], v['status']);
		}
	});
	$(document).trigger('widgetFormEvent', {event: 'connectionsPopulated'});
    };

CampaignActionCenter.ClearConnectionsRepeatInterval = function() {
    if (typeof CampaignActionCenter.phoneconnectionsrepeat != 'undefined') {
        clearInterval(CampaignActionCenter.phoneconnectionsrepeat);
    }
};

CampaignActionCenter.HideLoaders = function() {
    $('#submitloadingcontainer, .loading-officials-container').hide();
};

$(document).ready(function(){
	/*
	*
	*	FACEBOOK actions
	*
	*/
	
	$('#actioncenterform').on('click', '.official-post', function(e) {
		//We don't want the info button to trigger selecting/deselecting the official
		e.stopPropagation();
		var $me = $(this);
		var messageid = $me.attr('data-messageid');
		if (typeof messageid !== 'undefined' && messageid) {
			var messageinfo = CampaignActionCenter.facebook.messages[messageid];
			if (typeof messageinfo !== 'undefined') {
				var $previewmodal = $('#campaignFacebookPreview');
				$previewmodal.find('.message-subject').html(messageinfo.subject);
				$previewmodal.find('.message-body').html('<div class="message-greeting">' + messageinfo.greeting + '</div>' + messageinfo.body);
				$previewmodal.modal('show');
			}
		}
	});

	$('#facebookdeniedpermissionsubmitbutton').click(function() {
		$('#facebooksubmitbutton, #steptwocontainer .facebooksubmitbutton').trigger('click');
	});
	/* END FACEBOOK ACTIONS */

    //Set the preview containers based on template
                    var $actionexplanation = $('#actionexplanation');
        CampaignActionCenter.facebook.$previewcontainer = $('#facebookpreviewcontainer');
        CampaignActionCenter.twitter.$previewcontainer = $('#twitterpreviewcontainer');
        CampaignActionCenter.call.$previewcontainer = $actionexplanation;
        CampaignActionCenter.email.$previewcontainer = $('#emailpreviewcontainer');
    
/*
	setTimeout(function() {
		CampaignActionCenter.facebook.ShowPostsError();
					}, 1000);
*/

	$('#action-container').on('click', '#facebookpostsreconnect', function() {
		CampaignActionCenter.facebook.Reconnect();
		return false;
	});

	//Set it to 0 to start so everything disappears right away on page load. At the end of the function, set it to what we really want (a slower speed)
	window.actiontransitionspeed = 0;
	window.campaignurl = '';

			//Initiate Pusher
		CampaignActionCenter.facebook.postspusher = p2apusherapp.pusher.subscribe('ac-fbposts');
	
	$('#actioncenterform').on('click', '.facebook-preview .legislator, .officials li', function() {
		var $me = $(this);
		if ($me.hasClass('official-available')) {
			CampaignActionCenter.facebook.SelectLegislator($me.attr('data-uniqueid'));
		} else {
			CampaignActionCenter.facebook.UnselectLegislator($me.attr('data-uniqueid'));
		}
	});
    $('#actioncenterform').on('click', '#sharepost', function() {
        var $me = $(this);
        if ($me.is(':checked')) {
            CampaignActionCenter.facebook.SelectLegislator('advocatesown');
        } else {
            CampaignActionCenter.facebook.UnselectLegislator('advocatesown');
        }
    });

    var toggleUIPerFacebookMessageContent = function() {

        var $message = $('.fbpostcontent-editor');

                    var $submitButton = $('#facebooksubmitbutton');
            var $warningContainer = $('#facebook-msg-warning');
        

        if (!$message.length) {
            return;
        }

        CampaignActionCenter.facebook.typedtext = $message.val().length > 0;

        if (CampaignActionCenter.facebook.typedtext) {

            CampaignActionCenter.facebook.typedtext = true;
            $message.removeClass('red-border');
            $submitButton.removeClass('emptyMsg');
            $warningContainer.hide();
        } else {

            CampaignActionCenter.facebook.typedtext = false;
            $submitButton.addClass('emptyMsg');
            $warningContainer.show();
        }
    };

	CampaignActionCenter.facebook.$previewcontainer.on('keyup', '.fbpostcontent-editor', toggleUIPerFacebookMessageContent);

	

    $('#actioncenterform').on('officials-loading', function() {
        //Do not allow someone to close steptwo before it has fully loaded
        $('#steptwocontainer .close-dialog').prop('disabled', true);
    });
    $('#actioncenterform').on('officials-loaded', function() {
        $('#steptwocontainer .close-dialog').prop('disabled', false);
        
        //Select all the legislators
	    	        var $legscontainer = $('ul.officials li');
	    	    $.each($legscontainer, function() {
	        var leguniqueid = $(this).attr('data-uniqueid');
	        if (leguniqueid !== 'advocatesown') {
	            CampaignActionCenter.facebook.SelectLegislator(leguniqueid);
	        }
	    });
    });

	
	$('#fullname').on('keyup blur', function() {
		if ($(this).val() != '') {
			$('#email-sig').text($(this).val());
		} else {
			$('#email-sig').text('Your Name');
		}
	});

});

function showerrormessage(errormessage) {
	
	$('#action-container .advocate-action-error').show(400);

	if ($('#action-container .advocate-action-error').length <= 0) {
        var message = '<div class="alert alert-danger advocate-action-error" style="display: none;"><strong>Uh-Oh!</strong> ' + errormessage + '</div>';

        			$('#action-container #heading').after(message);
		
		//Ease it in
		$('#action-container .advocate-action-error').show(300);
	} else {
		$('#action-container .advocate-action-error').html('<strong>Uh-Oh!</strong> ' + errormessage);
	}

	// broadcast an event (delayed the time it takes for the error to be shown)
	setTimeout(function() {
		$(document).trigger('widgetFormEvent', {event: 'formError'});
	}, 400);

	$('html, body').animate({
		scrollTop: $('#action-container .advocate-action-error').offset().top
	}, 400);
}


function openSocial(network)
{


	if(network == 'twitter'){
	}

	if(network == 'facebook'){
		window.open("http://p2a.co/connect/facebook/18755?phone="+phone+"&zip5="+zip5+"&url=2XxyMpX&domain=p2a.co&suid=" + CampaignActionCenter.suid);
	}

}

window.numactionscompleted = 0;
window.checkboxescompleted = new Array();

function processCompletedCheckboxes() {
	//Checkboxes and radio buttons are unique as far as deciding when we've saved their data or not
	//Loop over them and store them in an array so we know not to show them for the next action
	$('#action-form :checkbox, #action-form :radio').each(function() {
		//If its visible and checked, add it to our list
		//If its not checked, we want to present it to the user again so they can check it on the next screen :)
		if ($(this).is(':visible') && $(this).is(':checked')) {
			window.checkboxescompleted.push($(this).attr('name'));
		}
	});
}
function actionCompleted(type, callcompleted, skipmarking) {
    //If passed a single string, stick it as the only element in our array
    var types = [];
    if (typeof type === 'string') {
        types.push({
            'type': type,
            'callcompleted': callcompleted,
            'skipmarking': skipmarking
        });
    } else {
        types = type;
    }
    var numoftypes = types.length;

    for (var typesi = 0; typesi < numoftypes; typesi++) {
        type = types[typesi].type;
        callcompleted = typeof types[typesi].callcompleted !== 'undefined' ? types[typesi].callcompleted : false;
        skipmarking = typeof types[typesi].skipmarking !== 'undefined' ? types[typesi].skipmarking : false;

        //Clear phone connections
        window.clearInterval(CampaignActionCenter.phoneconnectionsrepeat);

        var me = $('#action-' + type);

        window.numactionscompleted++;

        $('#submitloadingcontainer').hide();

        processCompletedCheckboxes();

        //Remove any error messages
        $('#action-container .advocate-action-error').remove();

        //Give everything a chance to load
        setTimeout(function () {
            $.event.trigger({
                type: "action",
                message: type
            });
        }, 100);

        if (type == 'email') {
            CampaignActionCenter.actions.actionscompleted.push(1);
        } else if (type == 'twitter') {
            CampaignActionCenter.actions.actionscompleted.push(2);
        } else if (type == 'facebook') {
            CampaignActionCenter.actions.actionscompleted.push(3);
        } else if (type == 'call') {
            CampaignActionCenter.actions.actionscompleted.push(4);
        } else if (type == 'lookup') {
            CampaignActionCenter.actions.actionscompleted.push(5);
        }

        deactivateAction(me);

        if (!skipmarking) {
            if ($(me).hasClass('action-completed') === true) {
                $(me).removeClass('action-completed');
                $('.actioncheckmark', me).hide();
            } else {
                $(me).addClass('action-completed');
                if (type == 'facebook') {
                    $('.action-image-status', me).html('Posting...').show();

					var fbPusherTooLong = window.setInterval(function() {
						//If pusher takes too long to come back, just mark this action as completed
						$('.action-image-status', me).html('').hide();
						$('.actioncheckmark', me).show();

						window.clearInterval(fbPusherTooLong);
						return false;
					}, 20000);

                    //Bind to Pusher
                    CampaignActionCenter.facebook.postspusher.bind('completed', function (data) {
						if (data.campaignid && data.campaignid.toString() == '18755'
                                &&
                                data.advocateid && data.advocateid.toString() == window.advocateid.toString()) {
							window.clearInterval(fbPusherTooLong);
							if (data.error && data.error.toString() == '1') {
                                //Show the errors
                                CampaignActionCenter.facebook.ShowPostsError();
                            } else {
                                //Otherwise, mark action as completed
                                $('.action-image-status', me).html('').hide();
                                $('.actioncheckmark', me).show();
                            }
                        }
                    });
                } else {
                    $('.actioncheckmark', me).show();
                }
                /*var child = $('.actioncheckmark', me);
                 var parent = $(me);
                 child.css("top", ((parent.height() - child.outerHeight()) / 2) + parent.scrollTop() + "px");
                 child.css("left", ((parent.width() - child.outerWidth()) / 2) + parent.scrollLeft() + "px");*/
            }
        }

        /*$('#actions .action').not(me).each(function() {
         $(this).removeClass('action-completed');
         $('.actioncheckmark', this).hide();
         });*/
    }

    //Now set type equal to the last action
    type = types[(numoftypes - 1)].type;

    CampaignActionCenter.ShowStepOne();

	$('#actionexplanation').text('');

	//Now send them to the next action
	nextaction = determineIfLastAction(type);

		if (nextaction !== false && (type != 'call' || callcompleted === true) && type != 'email') {
			//Send user to this action
		nextaction.trigger('click');
	} else if (nextaction === false) {
		//If we get here, that means that all actions have been completed
					$('#actions').children().hide(400);
			$('#customfieldscontainer').hide();
			$('.disclaimer-container').hide();
			$('#completed-container').show(400);
			$('#action-container #heading').hide();
			$('#steponecontainer').hide();
			$('.actionsubmitbutton').hide();
			$('.disclaimer').hide();
			$('.campaign-call-to-action').hide();
			$('button.share-button').hide();

							$('#actionexplanation').show();
			
			$.event.trigger({
				type: "actions-completed"
			});

            CampaignActionCenter.twitter.$previewcontainer.hide();
            CampaignActionCenter.facebook.$previewcontainer.hide();

			//If our last action was email, show the legs contacted
			
			if (type != 'email' && type != 'call') {
				$('#action-form').hide();
			}
			}

		if (type == 'email' && CampaignActionCenter.email.actioncompleted !== true) {
		var data = {};
		data.advocateid = window.advocateid;
		callreturned('email', data);
	}
		if (type == 'call' && callcompleted === false) {
		var data = {};
		data.advocateid = window.advocateid;
		callreturned('phone', data);
	}

	// broadcast an event
	$(document).trigger('widgetFormEvent', {event: 'actionCompleted'});
}

function determineIfLastAction(type) {
	//If they just finished a Twitter or FB action, send them to the next social action
	//Otherwise, priority is email -> twitter -> facebook -> call
	var actionpriority = new Array();

			if (type == 'twitter' || type == 'facebook') {
			actionpriority.push($('#action-twitter'));
			actionpriority.push($('#action-facebook'));
			actionpriority.push($('#action-email'));
			actionpriority.push($('#action-call'));
		} else {
			actionpriority.push($('#action-email'));
			actionpriority.push($('#action-twitter'));
			actionpriority.push($('#action-facebook'));
			actionpriority.push($('#action-call'));
		}
	
	for (var i = 0, n = actionpriority.length; i < n; i++) {
		var action = actionpriority[i];
		if (action.length > 0 && action.hasClass('action-completed') === false) {
			return action;
		}
	}
	//If we get here, we didn't find another action to go to
	return false;
}

function activateAction(me) {
    var $me = $(me);
	var action = $me.attr('id');
	if (action) {
		action = action.replace('action-', '');
	}

			$me.show();
	
	$('#actions .action').not($me).removeClass('active-action');
    $me.addClass('active-action');

	$('.action-image', $me).addClass('active-action-icon');
	$('.action-arrow', $me).hide();

	$('#actions .action .action-image').not($('.action-image', $me)).each(function() {
		$(this).removeClass('active-action-icon');
		$('.action-arrow', $(this).parent()).show();
	});

	//Remove any error messages
	$('#action-container .advocate-action-error').hide(function() {
		$(this).remove();
	});

        if (action != 'twitter') {
        CampaignActionCenter.twitter.$previewcontainer.hide();
    } else {
        CampaignActionCenter.twitter.$previewcontainer.show();
    }
    if (action != 'facebook') {
        CampaignActionCenter.facebook.$previewcontainer.hide();
    } else {
        CampaignActionCenter.facebook.$previewcontainer.show();
    }
    if (action != 'email') {
        CampaignActionCenter.email.$previewcontainer.hide();
    } else {
        CampaignActionCenter.email.$previewcontainer.show();
    }

//	if (action == 'twitter' && CampaignActionCenter.twitter.shownlegs !== false) {
//        CampaignActionCenter.twitter.$previewcontainer.show();
//	} else if (action == 'facebook' && CampaignActionCenter.facebook.shownlegs !== false) {
//        CampaignActionCenter.facebook.$previewcontainer.show();
//    } else if (action == 'email' && CampaignActionCenter.emailpreviewed !== false) {
//        CampaignActionCenter.email.$previewcontainer.show();
//    }
    
    // broadcast an event
	$(document).trigger('widgetFormEvent', {event: 'actionActivated'});
}
function deactivateAction(me) {
    $(me).removeClass('active-action');
	$('.action-image', me).removeClass('active-action-icon');
	$('.action-arrow', me).remove();

	// broadcast an event
	$(document).trigger('widgetFormEvent', {event: 'actionDeactivated'});
}

function serializeToObject(formdataserialized) {
	var formdata = {};
	var formdataserialized = $('#action-container form').serializeArray();
    $.each(formdataserialized, function() {
        if (formdata[this.name] !== undefined) {
            if (!formdata[this.name].push) {
                formdata[this.name] = [formdata[this.name]];
            }
            formdata[this.name].push(this.value || '');
        } else {
            formdata[this.name] = this.value || '';
        }
    });

    return formdata;
}

function callreturned(type, returndata) {
	//Don't forward to another action; instead, tell the advocate they are being connected, and show a call script
	var speed = 400;
	$('#action-form :input, #action-form :checkbox, #action-form :radio').each(function() {
        var formelementid = $(this).attr('id');
		if (formelementid == 'fullname' || formelementid == 'prefix') {
			$(this).parent().parent().hide(speed);
		} else {
			if ($(this).hasClass('actionsubmitbutton')) {
				$(this).hide(speed);
			} else {
				$(this).parent().hide(speed);
			}
		}
	});

	if (type == 'phone') {
		var contactphonescript = "";
		if ($('#contactPhoneScript').html() !== undefined) {
			contactphonescript = $('#contactPhoneScript').html();
		}
	}

	if (returndata.advocateid !== undefined) {
		if (type == 'phone') {
            if (typeof returndata.view !== 'undefined' || typeof CampaignActionCenter.call.returndata.view !== 'undefined') {
                var calldata = returndata.view;
                if (typeof calldata === 'undefined') {
                    calldata = CampaignActionCenter.call.returndata.view;
                }
                CampaignActionCenter.call.$previewcontainer.html(calldata);
                CampaignActionCenter.ShowStepTwo('call');
            } else {
                var contactPhoneConnectedWithMessage = 'You\'re about to be connected with:';
                
                $('#action-tips-container .action-tip[data-action="call"]').hide();
                var explanationcode = '<p class="text-center applabel"><strong>' + contactPhoneConnectedWithMessage + '</strong></p><ul class="legislators-called"></ul>' + contactphonescript;
                                CampaignActionCenter.call.$previewcontainer.html(explanationcode);
            }
		} else if (type == 'email') {
							CampaignActionCenter.email.$previewcontainer.html('<p class="text-center applabel"><strong>You just contacted:</strong></p><ul class="legislators-called"></ul>');
                CampaignActionCenter.ShowStepTwo('email');
					}

		$('#submitloadingcontainer').show()
		window.legfetchcount = 0;

        		CampaignActionCenter.phoneconnectionsrepeat = window.setInterval(function(){
				var formdata = new Object();

				if (type == 'phone') {
					formdata.connecttype = 'CALL';
                    var showconnectionstype = 'call';
				} else if (type == 'email') {
					formdata.connecttype = 'EMAIL';
                    var showconnectionstype = 'email';
				}

				$.ajax({
					url: '/ajax/connections/' + returndata.advocateid + '/18755',
					data: formdata,
					success: function(data){
						if(data.length > 0){
							CampaignActionCenter.ShowConnections(data, showconnectionstype);
                            CampaignActionCenter.ShowStepTwo(showconnectionstype);

							$('#submitloadingcontainer').hide();
							window.clearInterval(CampaignActionCenter.phoneconnectionsrepeat);
						}

						var maxFetchAttempts = 10;

						if(window.legfetchcount >= maxFetchAttempts) {
						    //On the tenth try, give up
							window.clearInterval(CampaignActionCenter.phoneconnectionsrepeat);
							$('#submitloadingcontainer').hide();

							if (!$('.legislators-called').html()) {
							    //If there are no connections found, show an error message
                                showerrormessage('No officials were found for your area. Please check back later.');
                                if (type === 'phone') {
                                    CampaignActionCenter.call.$previewcontainer.html('').hide();
                                } else if (type === 'email') {
                                	CampaignActionCenter.email.$previewcontainer.html('').hide();
								}
                            }

						}

						window.legfetchcount++;
					}
				});
		}, 2000);
                    }

    // broadcast an event
	$(document).trigger('widgetFormEvent', {event: 'callReturned'});

	return true;
}

function setAdvocateId(advocateid) {
	if (advocateid !== undefined) {
		window.advocateid = advocateid;

		$('.webintent-sharebtn').each(function() {
			//If advocateid isn't in the URL, add it
			var link = $(this).attr('href');
			//If advocateid is already set as a url param, this will result in duplicate URL params, but thats ok; the PHP will choose the latest one, which is the one we want it to look at.
			$(this).attr('href', link + '&advocateid=' + advocateid);
		});
	}
}


$(function() {
/*
$('#facebooksubmitbutton').click(function(e) {
	e.stopImmediatePropagation();
	actionCompleted('facebook');
	return false;
});
*/
    var getFacebookSubmitButtons = function() {
        return $('#facebooksubmitbutton, .facebooksubmitbutton');
    };

    var getEmailSubmitButtons = function() {
        return $('#emailsubmitbutton, .emailsubmitbutton');
    };

    var getTwitterSubmitButtons = function() {
        return $('#twittersubmitbutton, .twittersubmitbutton');
    };

    $('.close-dialog').on('click', function() {
        var action = $(this).attr('data-action');
        if (!action || !action.length) {
            action = '';
        }

        if (CampaignActionCenter.phoneconnectionsrepeat) {
            window.clearInterval(CampaignActionCenter.phoneconnectionsrepeat);
            $('#submitloadingcontainer').hide();
        }

        if (action == 'email') {
            CampaignActionCenter.emailpreviewed = 0;
            getEmailSubmitButtons().html(CampaignActionCenter.email.originalbutton);
            $('#steptwocontainer .email-preview').html('');
            if (CampaignActionCenter.email.actioncompleted === true) {
                //If the action is already completed, we want to trigger a click to the next action
                //The reason why email-preview might still be open is because we are showing the legs you just contacted
                actionCompleted('email', false, true);
            }
        } else if (action == 'facebook') {
            CampaignActionCenter.facebook.shownlegs = false;
            $('.facebooksubmitbutton').html(CampaignActionCenter.facebook.originalbutton);
            $('#steptwocontainer .facebook-preview').html('');
        } else if (action == 'twitter') {
            CampaignActionCenter.twitter.shownlegs = false;
            $('.twittersubmitbutton').html(CampaignActionCenter.twitter.originalbutton);
            $('#steptwocontainer .twitter-preview').html('');
        } else if (action == 'call') {
            $('#steptwocontainer .call-preview').html('');
            //Call is completed, mark it as such
            actionCompleted('call', true, true);
        }

        $('.facebooksubmitbutton').removeAttr('disabled');

        $('#submitloadingcontainer').hide();
        CampaignActionCenter.ShowHiddenInputs();

        if (action !== 'call') {
            //actionCompleted calls ShowStepOne, so no need toc all it here
            CampaignActionCenter.ShowStepOne(action);
        }
    });

    //Twitter length count
    CampaignActionCenter.twitter.$previewcontainer.on('keyup paste', '.tweetcontentcontainer textarea', function() {
        var $me = $(this);
        var remaining = P2A.Helpers.Twitter.countRemainingCharacters($me.val(), false);
        remaining < 0 ? $me.addClass('tweet-overlength') : $me.removeClass('tweet-overlength');
    });

	$('#action-container').keydown(function(e) {
		//If user presses enter, don't do normal form functionality, use our functionality
		var code = e.keyCode || e.which;

		if(code == 13 && $(document.activeElement).prop("tagName").toLowerCase() != 'textarea') {
			//Hide mobile keyboard
			$(document.activeElement).blur();

			//Find out which button to trigger
			$('#action-container .actionsubmitbutton').each(function() {
				if ($(this).is(':visible')) {
					$(this).trigger('click');
					return false;
				} else {
					return true; //continue
				}
			});

			e.preventDefault();
			return false;
		}
	});

	$('#action-container').on('click', '.actionsubmitbutton', function(e) {
				var me = this;
        var $me = $(me);
		var parentid = $(me).attr('id');
		var type = '';

		if (parentid == 'twittersubmitbutton' || $me.hasClass('twittersubmitbutton')) {
			type = 'twitter';
		} else if (parentid == 'facebooksubmitbutton' || $me.hasClass('facebooksubmitbutton')) {
			type = 'facebook';
		} else if (parentid == 'emailsubmitbutton' || $me.hasClass('emailsubmitbutton')) {
			type = 'email';
		} else if (parentid == 'callsubmitbutton' || $me.hasClass('callsubmitbutton')) {
			type = 'call';
		} else if (parentid == 'lookupsubmitbutton' || $me.hasClass('lookupsubmitbutton')) {
			type = 'lookup';
		}


		// insert mixpanel code for different Call to action types
		// determines if the actionsubmitbutton was clicked
		var mixpanelContactInfoSubmitted = {
			name: CampaignActionCenter.MixPanel.CreateEventMessage("Contact Info Submitted"),
			data: CampaignActionCenter.MixPanel.GenerateParams({
				'action': type, 'campaignID': '18755', 'whenCampaignIDSubmitted': 'after contact info'})
		};



		if (type != 'call') {
			//Clear phone connections
			window.clearInterval(CampaignActionCenter.phoneconnectionsrepeat);
		}

		if (type == 'twitter') {
            $('#steptwocontainer .close-dialog').attr('data-action', 'twitter');

            var twittersubmitbuttontext = "Post Tweets";
                            twittersubmitbuttontext = '<i class="fa fa-twitter fa-lg action-image"></i> ' + twittersubmitbuttontext;
            
			if (CampaignActionCenter.twitter.shownlegs === false) {

				//The Contact Info page has been shown and submitted. Step 1 of Twitter action is completed.
				mixpanel.track(mixpanelContactInfoSubmitted.name, mixpanelContactInfoSubmitted.data);
				mixpanel.time_event(CampaignActionCenter.MixPanel.CreateEventMessage("Twitter Message Time Elapsed"));
                $('#actioncenterform').trigger('officials-loading');

				CampaignActionCenter.HideCookieBadge();

				var formdata = serializeToObject($('#action-container form').serializeArray());

				formdata.noredirect = 1;

				formdata.domain = 'p2a.co';
				formdata.url = '2XxyMpX';
				if (CampaignActionCenter.suid) {
					formdata.suid = CampaignActionCenter.suid;
				}
				formdata.shorturl = '2XxyMpX';
				formdata.advocateid = window.advocateid;
				formdata.campaignid = '18755';
				formdata.showlegphotos = '1';
				formdata.sharetwitterbody = "President Trump is almost done with putting in place zero tolerance for criminal aliens. learn more here.[@campaign]";
				formdata.contactTwitterAllInOne = '0';
				formdata.ac = new Array();
				$.each(CampaignActionCenter.actions.actionscompleted, function(index, value) {
					formdata.ac.push(value);
				});

				//Show the loading message and remove the explanation of the Twitter action
                var $twittersubmitbuttons = getTwitterSubmitButtons();
				$('#actionexplanation').html('');
				//$('#twittersubmitbutton, .twittersubmitbutton > .post-right').html('Post Tweets <i class="fa fa-chevron-right"></i>');
                CampaignActionCenter.twitter.originalbutton = $twittersubmitbuttons.html();
                $twittersubmitbuttons.html(twittersubmitbuttontext).hide();

                CampaignActionCenter.twitter.$previewcontainer.html('<div class="loading-officials-container">Loading Officials<br/><img src="/img/functions/ajax-loader-horizontal-light.gif"></div>').show();
                CampaignActionCenter.ShowStepTwo('twitter');

				//Run the checked checkboxes; we'll remove them then if there is an error. But we've gotta store them while they are visible
				processCompletedCheckboxes();
				//Store the elements we are about to change to hidden, so we can show them if there is an error
                CampaignActionCenter.HideVisibleInputs();
                //hide any previous errors
				$('#action-container .alert-danger').hide();

				//Set a timeout in case our twitter call takes a long time - 15 seconds.
				var twittergetlegscalltoolong = window.setInterval(function() {
																		window.clearInterval(twittergetlegscalltoolong);
																		//Kill the ajax call - the php will still run in the background, but when it returns, it won't do anything to conflict with what we are doing now
																		twittergetlegscall.abort();
																		showerrormessage('Finding your officials is taking too long - please try again in a little bit.');
                                                                        CampaignActionCenter.twitter.$previewcontainer.html('').hide();
																		$twittersubmitbuttons.prop('disabled', false).show();
																		//$('#twittersubmitbutton, .twittersubmitbutton > .post-right').html('Post Tweets <i class="fa fa-chevron-right"></i>').show();
																		mixpanel.track(
																		    "Twitter get legs took too long",
																		    {
																			    "Data": formdata
																			}
																		);

																		return false;
																	}, 30000);
				//Now we want to get and show the Twitter officials
				var twittergetlegscall = $.ajax({
											type: 'post',
											url: '/ajax/actioncenter/twitter/getlegs',
											dataType: 'json',
											data: formdata,
											success: function(returndata){
												window.clearInterval(twittergetlegscalltoolong);
												if (returndata.notactive) {
													//Mark action as completed and trigger a click; this will hide the form inputs
													window.numactionscompleted++;
													processCompletedCheckboxes();
													$('#action-twitter').trigger('click');
													actionCompleted('twitter', false);
													showerrormessage(returndata.notactive);
                                                    CampaignActionCenter.twitter.$previewcontainer.html('').hide();
												} else if (returndata.errormessage) {
													showerrormessage(returndata.errormessage);
                                                    CampaignActionCenter.twitter.$previewcontainer.html('').hide();
                                                    CampaignActionCenter.ShowStepOne('twitter');
                                                    getTwitterSubmitButtons().filter(':first').show();
													//$('#twittersubmitbutton, .twittersubmitbutton > .post-right').html('Post Tweets <i class="fa fa-chevron-right"></i>').show();
                                                    $('#submitloadingcontainer').hide();
                                                    CampaignActionCenter.ShowHiddenInputs();
												} else if (returndata.numoflegs == 0 && !formdata.sharetwitterbody) {
													//Mark action as completed and trigger a click; this will hide the form inputs
													window.numactionscompleted++;
													processCompletedCheckboxes();
													$('#action-twitter').trigger('click');
													actionCompleted('twitter', false);
													showerrormessage('No officials were found for your area. Please check back later.');
                                                    CampaignActionCenter.twitter.$previewcontainer.html('').hide();
												} else {
													CampaignActionCenter.twitter.sharebody = returndata.sharetwitterbody;
													CampaignActionCenter.twitter.shownlegs = true;

                                                                                                            //Mark action as completed and trigger a click; this will hide the form inputs
                                                        window.numactionscompleted++;
                                                        processCompletedCheckboxes();
                                                        $('#action-twitter').trigger('click');
                                                    
													if (returndata.advocateid) {
														setAdvocateId(returndata.advocateid);
													}

                                                    if (returndata.view) {
                                                        var previewcode = returndata.view;
                                                    } else {
                                                        var previewcode = returndata.code;
                                                        													    if (returndata.numoflegs > 0 && formdata.sharetwitterbody) {
                                                            previewcode += '<label class="sharesociallabel"><input type="checkbox" name="sharetweet" id="sharetweet" value="1" checked> Share with my followers</label>';
                                                        }
                                                                                                            }

													CampaignActionCenter.twitter.$previewcontainer.html(previewcode).show();

                                                    //Set the button text again with a un-cached version
                                                    getTwitterSubmitButtons().prop('disabled', false).html(twittersubmitbuttontext).show();

													// broadcast an event
                									$(document).trigger('widgetFormEvent', {event: 'twitterShowLegs'});
												}
                                                $('#actioncenterform').trigger('officials-loaded');
											},
											error: function(w,t,f) {
												window.clearInterval(twittergetlegscalltoolong);
												//Kill the ajax call - the php will still run in the background, but when it returns, it won't do anything to conflict with what we are doing now
												showerrormessage('An error occurred finding your officials - please try again in a little bit.');
                                                CampaignActionCenter.twitter.$previewcontainer.html('').hide();
												$('#submitloadingcontainer').hide();
												//$('#twittersubmitbutton, .twittersubmitbutton').show();
                                                getTwitterSubmitButtons().filter(':first').prop('disabled', false).html('Post Tweets <i class="fa fa-chevron-right"></i>').show();
												mixpanel.track(
												    "Twitter get legs javascript error",
												    {
													    "Data": formdata,
													    "w": w,
													    "t": t,
													    "f": f
													}
												);
											}
										});
				//var redirecturl = "http://p2a.co/ajax/actioncenter/twitter/authenticate?campaignid=18755&email=" + encodeURIComponent(formdata.email) + "&phone=" + encodeURIComponent(formdata.phone) + "&address1=" + encodeURIComponent(formdata.address1) + "&zip5=" + encodeURIComponent(formdata.zip5) + "&subscribeSms=" + encodeURIComponent(formdata.subscribeSms) + "&subscribeEmail=" + encodeURIComponent(formdata.subscribeEmail) + "&url=" + encodeURIComponent('2XxyMpX') + "&shorturl=" + encodeURIComponent('2XxyMpX') + "&vade=t";

				/*
$.each(CampaignActionCenter.actions.actionscompleted, function(index, value) {
					redirecturl += '&ac[]=' + encodeURIComponent(value);
				});
				if (window.advocateid) {
					redirecturl += '&advocateid=' + encodeURIComponent(window.advocateid);
				}

									window.location.href = redirecturl;
				*/
				//window.parent.parent.window.open(redirecturl);
				//window.location.href = redirecturl;
				//window.parent.parent.window.location.href = redirecturl;

				return false;
			} else {

				//The legislators page was shown and message was edited. The second step for twitter submission is completed.
				mixpanel.track(CampaignActionCenter.MixPanel.CreateEventMessage("Twitter Message Time Elapsed"),CampaignActionCenter.MixPanel.GenerateParams({'action': "twitter"}));
				mixpanel.track(CampaignActionCenter.MixPanel.CreateEventMessage("Outbound Contact to Legislator Started"), CampaignActionCenter.MixPanel.GenerateParams({"action": "twitter"}));




				
				//$('#twittersubmitbutton, .twittersubmitbutton').hide();
				//$('#submitloadingcontainer').show();
                var $twittersubmitbuttons = getTwitterSubmitButtons();
                $twittersubmitbuttons.html('Posting... <i class="fa fa-spin fa-spinner"></i>').prop('disabled', true);

				var formdata = serializeToObject($('#action-container form').serializeArray());

				formdata.campaignid = '18755';
				formdata.advocateid = window.advocateid;
				formdata.domain = 'p2a.co';
				formdata.shorturl = '2XxyMpX';
				if (CampaignActionCenter.suid) {
					formdata.suid = CampaignActionCenter.suid;
				}
				if ($('#sharetweet').is(':checked')) {
					formdata.share = 1;
					formdata.sharetwitterbody = "President Trump is almost done with putting in place zero tolerance for criminal aliens. learn more here.[@campaign]";
				} else {
					formdata.share = 0;
				}

				//hide any previous errors
				$('#action-container .alert-danger').hide();
				//Set a timeout in case our twitter call takes a long time - 15 seconds.
				var twittercalltoolong = window.setInterval(function() {
															//Kill the ajax call - the php will still run in the background, but when it returns, it won't do anything to conflict with what we are doing now
															twittercall.abort();
															//Mark this action as completed
															actionCompleted(type);
															window.clearInterval(twittercalltoolong);

															mixpanel.track(
															    "Twitter posting took too long",
															    {
																    "Data": formdata
																}
															);

															return false;
														}, 30000);
				var twittercall = $.ajax({
									type: 'post',
									url: '/ajax/actioncenter/twitter/post',
									dataType: 'json',
									data: formdata,
									success: function(returndata){
										window.clearInterval(twittercalltoolong);

										if (returndata.success == 1) {

											//Twitter authentication was successful, and id's are linked.
										//	mixpanel.track("UX Outbound Contact to Legislator Success", {"action": "twitter"});
											mixpanel.track(CampaignActionCenter.MixPanel.CreateEventMessage("Outbound Contact to Legislator Success"), CampaignActionCenter.MixPanel.GenerateParams({"action": "twitter"}));

                                            CampaignActionCenter.twitter.$previewcontainer.html('').hide();
											//Mark this action as completed
											actionCompleted(type);

																					} else if (returndata.success = 5 && returndata.redirecturl) {
																							window.location.href = returndata.redirecturl;
																						// broadcast an event
                							$(document).trigger('widgetFormEvent', {event: 'twitterPostSuccess'});
											return false;
										} else {
                                            $twittersubmitbuttons.prop('disabled', false).html(twittersubmitbuttontext).show();
											$('#submitloadingcontainer').hide();

											// broadcast an event
                							$(document).trigger('widgetFormEvent', {event: 'twitterPostError'});

											if (returndata.errormessage) {
												showerrormessage(returndata.errormessage);
												return false;
											}
										}
									},
									error: function(w,t,f) {
										window.clearInterval(twittercalltoolong);
										//Kill the ajax call - the php will still run in the background, but when it returns, it won't do anything to conflict with what we are doing now
										showerrormessage('An error occurred finding your officials - please try again in a little bit.');
                                        CampaignActionCenter.twitter.$previewcontainer.html('').hide();
										$('#submitloadingcontainer').hide();
										$('#twittersubmitbutton, .twittersubmitbutton').prop('disabled', false).show();
										//$('#twittersubmitbutton, .twittersubmitbutton').prop('disabled', false).html('Post Tweets <i class="fa fa-chevron-right"></i>').show();
										mixpanel.track(
										    "Twitter posting javascript error",
										    {
											    "Data": formdata,
											    "w": w,
											    "t": t,
											    "f": f
											}
										);

										// broadcast an event
                						$(document).trigger('widgetFormEvent', {event: 'twitterPostError'});
									}
								});
			}
		} else if (type == 'facebook') {
            $('#steptwocontainer .close-dialog').attr('data-action', 'facebook');

            var facebooksubmitbuttontext = "Post Now";
                            facebooksubmitbuttontext = '<i class="fa fa-facebook fa-lg action-image"></i> ' + facebooksubmitbuttontext;
            
			var $facebookSubmitButtons = $('#facebooksubmitbutton, .facebooksubmitbutton');

            if (CampaignActionCenter.facebook.shownlegs === false) {
            	//The Contact Info page has been shown and submitted. Step 1 of Facebook action is completed.
            	mixpanel.track(mixpanelContactInfoSubmitted.name, mixpanelContactInfoSubmitted.data);

            	mixpanel.track(CampaignActionCenter.MixPanel.CreateEventMessage("Outbound Contact to Legislator Success"), CampaignActionCenter.MixPanel.GenerateParams({"action": "facebook"}));

            	mixpanel.time_event(CampaignActionCenter.MixPanel.CreateEventMessage("Facebook Message Time Elapsed"));

				CampaignActionCenter.HideCookieBadge();
				$('#actioncenterform').trigger('officials-loading');

				var formdata = serializeToObject($('#action-container form').serializeArray());

				formdata.noredirect = 1;

				//Show the loading message and remove the explanation of the Facebook action
				$('#actionexplanation').html('');

				CampaignActionCenter.facebook.originalbutton = $('#facebooksubmitbutton, .facebooksubmitbutton').html();
                $('#facebooksubmitbutton, .facebooksubmitbutton').html(facebooksubmitbuttontext).hide();
                CampaignActionCenter.facebook.$previewcontainer.html('<div class="loading-officials-container">Loading Officials<br/><img src="/img/functions/ajax-loader-horizontal-light.gif"></div>').show();
                CampaignActionCenter.ShowStepTwo('facebook');

				//Now we want to get and show the Twitter officials
				formdata.domain = 'p2a.co';
				formdata.url = '2XxyMpX';
				if (CampaignActionCenter.suid) {
					formdata.suid = CampaignActionCenter.suid;
				}

				formdata.shorturl = '2XxyMpX';
				formdata.advocateid = window.advocateid;
				formdata.campaignid = '18755';
				formdata.showlegphotos = '1';
				formdata.widget = '';
				formdata.ac = new Array();
				$.each(CampaignActionCenter.actions.actionscompleted, function(index, value) {
					formdata.ac.push(value);
				});
				if (window.advocateid) {
					formdata.advocateid = window.advocateid;
				}
				//Get some Facebook post info so we can show the user what they saw before
				
				//Run the checked checkboxes; we'll remove them then if there is an error. But we've gotta store them while they are visible
				processCompletedCheckboxes();
				//Store the elements we are about to change to hidden, so we can show them if there is an error
                CampaignActionCenter.HideVisibleInputs();
				//hide any previous errors
				$('#action-container .alert-danger').hide();

				//Set a timeout in case our facebook call takes a long time - 30 seconds.
				var facebookgetlegscalltoolong = window.setInterval(function() {
																		window.clearInterval(facebookgetlegscalltoolong);

																		//Kill the ajax call - the php will still run in the background, but when it returns, it won't do anything to conflict with what we are doing now
																		facebookgetlegscall.abort();
																		showerrormessage('Finding your officials is taking too long - please try again in a little bit.');
                                                                        CampaignActionCenter.facebook.$previewcontainer.html('').hide();
																		//$('#facebooksubmitbutton > .post-right').html('Find Legislators <i class="fa fa-chevron-right"></i>').show();
																		$('#facebooksubmitbutton, .facebooksubmitbutton').html(facebooksubmitbuttontext).show();
																		//$('#facebooksubmitbutton').show();
																		return false;
																	}, 30000);
				var facebookgetlegscall = $.ajax({
													type: 'post',
													url: '/ajax/actioncenter/facebook/getlegs',
													dataType: 'json',
													data: formdata,
													success: function(returndata){
														window.clearInterval(facebookgetlegscalltoolong);
														if (returndata.notactive) {
															//Mark action as completed and trigger a click; this will hide the form inputs
															window.numactionscompleted++;
															processCompletedCheckboxes();
															$('#action-facebook').trigger('click');
															actionCompleted('facebook', false);
															showerrormessage(returndata.notactive);
                                                            CampaignActionCenter.facebook.$previewcontainer.html('');
                                                            // broadcast an event
                											$(document).trigger('widgetFormEvent', {event: 'facebookGetLegsInactive'});
														} else if (returndata.errormessage) {
															showerrormessage(returndata.errormessage);
                                                            CampaignActionCenter.facebook.$previewcontainer.html('').hide();
															var facebookbuttoncontent = '<div class="post-left"><i class="fa fa-facebook-square"></i></div>';
																facebookbuttoncontent += '<div class="post-right">' + "Post Now";
																facebookbuttoncontent += ' <i class="fa fa-chevron-right"></i></div>';

                                                            getFacebookSubmitButtons().hide();
															//$('#facebooksubmitbutton').html(facebookbuttoncontent).hide();
															//Show the inputs again now that we came back
                                                            CampaignActionCenter.HideLoaders();
                                                            CampaignActionCenter.ShowHiddenInputs();

															$facebookSubmitButtons.prop('disabled', false);
																														                                                                getFacebookSubmitButtons().filter(':first').html('Find Legislators').show();
																														// broadcast an event
                											$(document).trigger('widgetFormEvent', {event: 'facebookGetLegsError'});
														} else {
															CampaignActionCenter.facebook.shownlegs = true;
															$facebookSubmitButtons.addClass('emptyMsg');


                                                                                                                            //Mark action as completed and trigger a click; this will hide the form inputs
                                                                window.numactionscompleted++;
                                                                processCompletedCheckboxes();
                                                                $('#action-facebook').trigger('click');
                                                            
															if (returndata.advocateid) {
																setAdvocateId(returndata.advocateid);
															}

                                                            if (returndata.view) {
                                                                var previewcode = returndata.view;
                                                            } else {
                                                                var previewcode = returndata.code;
                                                            }

															CampaignActionCenter.facebook.numofmentions = returndata.numoflegs;

                                                            CampaignActionCenter.facebook.$previewcontainer.html(previewcode).show();
                                                            //Set the button text again
                                                            getFacebookSubmitButtons().filter(':first').html(facebooksubmitbuttontext).show();
                                                            CampaignActionCenter.ShowStepTwo('facebook');

															$('.facebook-permissions-warning').show();

															//"select" each legislator
															if (typeof returndata.chosenlegs !== 'undefined') {
																var $legscontainer = $('ul.officials li');
																$.each($legscontainer, function() {
																	var leguniqueid = $(this).attr('data-uniqueid');

																	if ($.inArray(leguniqueid.toString(), returndata.chosenlegs) === -1) {
																		CampaignActionCenter.facebook.UnselectLegislator(leguniqueid);
																		CampaignActionCenter.facebook.unselectedlegs = true;
																	}
																});

															}

															// broadcast an event
                											$(document).trigger('widgetFormEvent', {event: 'facebookGetLegsSuccess'});
														}
                                                        $('#actioncenterform').trigger('officials-loaded');
													}
												});

				return false;

			} else {
				// if there is no message, do not post and highlight the textarea
				if ($facebookSubmitButtons.hasClass('emptyMsg')) {
					var fbMsgBox = $('.fbpostcontent-editor');
					fbMsgBox.addClass('red-border');
					$('html, body').scrollTop(fbMsgBox.offset().top);
                    e.preventDefault();
					return;
				}

				//The legislators page was shown and the message was edited. Facebook submission is completed.
				mixpanel.track(CampaignActionCenter.MixPanel.CreateEventMessage("Facebook Message Time Elapsed"), CampaignActionCenter.MixPanel.GenerateParams({"action": "facebook"}));
				mixpanel.track(CampaignActionCenter.MixPanel.CreateEventMessage("Outbound Contact to Legislator Started"), CampaignActionCenter.MixPanel.GenerateParams({"action": "facebook"}));

				
                $facebookSubmitButtons.html('Posting... <i class="fa fa-spin fa-spinner"></i>').prop('disabled', true);
				/*$('#facebooksubmitbutton, .facebooksubmitbutton').hide();
				$('#submitloadingcontainer').show();*/

				//First check if there is at least one leg selected
				var numoflegschosen = $('input[name="facebookchosenlegs[]"]:enabled');
				if (typeof numoflegschosen === 'undefined' || numoflegschosen.length == 0) {
					showerrormessage('Please select at least one place to post your Facebook message to.');
                    $facebookSubmitButtons.html(facebooksubmitbuttontext).prop('disabled', false);
					return false;
				}

				var formdata = serializeToObject($('#action-container form').serializeArray());

				formdata.campaignid = '18755';
				formdata.advocateid = window.advocateid;
				if (CampaignActionCenter.suid) {
					formdata.suid = CampaignActionCenter.suid;
				}
				formdata.domain = 'p2a.co';
				formdata.shorturl = '2XxyMpX';
				if ($('#sharefbpost').is(':checked')) {
					formdata.share = 1;
										formdata.sharefacebookbody = "President Trump is almost done with putting in place zero tolerance for criminal aliens. learn more here.";
									} else {
					formdata.share = 0;
				}
				//hide any previous errors
				$('#action-container .alert-danger').hide();

				var fbcalltoolong = window.setInterval(function() {
														//Kill the ajax call - the php will still run in the background, but when it returns, it won't do anything to conflict with what we are doing now
														fbcall.abort();
														//Mark this action as completed
														actionCompleted(type);


														window.clearInterval(fbcalltoolong);
														return false;
													}, 30000);

				var fbcall = $.ajax({
									type: 'post',
									url: '/ajax/actioncenter/facebook/post',
									dataType: 'json',
									data: formdata,
									success: function(returndata){
										window.clearInterval(fbcalltoolong);

										if (returndata.success == 1) {

											//Facebook authentication was successful.
											mixpanel.track(CampaignActionCenter.MixPanel.CreateEventMessage("Outbound Contact to Legislator Success"), CampaignActionCenter.MixPanel.GenerateParams({"action": "facebook"}));

                                            CampaignActionCenter.facebook.$previewcontainer.html('');
											//Mark this action as completed
											setTimeout(function() {
												actionCompleted(type);
											}, 100);
											
											// broadcast an event
                							$(document).trigger('widgetFormEvent', {event: 'facebookPostSuccess'});
										} else if (returndata.success = 5 && returndata.redirecturl) {
																							window.location.href = returndata.redirecturl;
																						// broadcast an event
                							$(document).trigger('widgetFormEvent', {event: 'facebookPostRedirect'});
											return false;
										} else {
											
											/*$('#facebooksubmitbutton, .facebooksubmitbutton').show();
											$('#submitloadingcontainer').hide();*/
                                            $facebookSubmitButtons.html(facebooksubmitbuttontext).prop('disabled', false);
                                            // broadcast an event
                							$(document).trigger('widgetFormEvent', {event: 'facebookPostError'});
										}
									}
								});
			}

		} else if (type == 'email') {

			//Email is generally a 1-step call to action, thus we start the timer immediately.
			mixpanel.time_event(CampaignActionCenter.MixPanel.CreateEventMessage("Email Message Time Elapsed"));

			mixpanel.track(CampaignActionCenter.MixPanel.CreateEventMessage("Outbound Contact to Legislator Started"), CampaignActionCenter.MixPanel.GenerateParams({"action": "email"}));
			//mixpanel.track("UX Outbound Contact to Legislator Started", {"action": "email"});

			CampaignActionCenter.HideCookieBadge();
			$('#steptwocontainer .close-dialog').attr('data-action', 'email');

            var emailsubmitbuttontext = "Send Emails";
                            emailsubmitbuttontext = '<i class="fa fa-envelope fa-lg action-image"></i> ' + emailsubmitbuttontext;
            
        //Serialize the data and then transform it into an object
			//This allows us to get ALL the fields, plus add a few of our own
			var formdata = serializeToObject($('#action-container form').serializeArray());

			formdata.noredirect = 1;

			if (!CampaignActionCenter.emailpreviewed) {
			    var $emailsubmitbuttons = getEmailSubmitButtons();
                $('#actioncenterform').trigger('officials-loading');
                CampaignActionCenter.HideVisibleInputs();
                CampaignActionCenter.email.originalbutton = $emailsubmitbuttons.html();
                $emailsubmitbuttons.html(emailsubmitbuttontext).hide();
                CampaignActionCenter.email.$previewcontainer.html('<div class="loading-officials-container">Loading Officials<br/><img src="/img/functions/ajax-loader-horizontal-light.gif"></div>');
                CampaignActionCenter.ShowStepTwo('email');

                                $('#actionexplanation').html('');
                
				CampaignActionCenter.email.twostep = true;

				formdata.previewonly = '1';
				formdata.action = 'email';
				//hide any previous errors
				$('#action-container .alert-danger').hide();

				var emailcalltoolong = window.setInterval(function() {
                    //Kill the ajax call - the php will still run in the background, but when it returns, it won't do anything to conflict with what we are doing now
															emailcall.abort();
															//Mark this action as completed
															actionCompleted(type);

															window.clearInterval(emailcalltoolong);
															return false;
														}, 15000);

				var emailcall = $.ajax({
									type: 'post',
									url: window.campaignurl,
									dataType: 'json',
									data: formdata,
									success: function(returndata){
									    window.clearInterval(emailcalltoolong);
										//If there an is an error message, show it and don't mark action as completed
										if (returndata.error) {
											getEmailSubmitButtons().filter(':first').show();
                                            CampaignActionCenter.HideLoaders();
											CampaignActionCenter.ShowHiddenInputs();

											showerrormessage(returndata.error);

											CampaignActionCenter.ShowActionFields('action-email', true);

											// broadcast an event
                							$(document).trigger('widgetFormEvent', {event: 'legEmailError'});
										} else if (returndata.success == '1') {
										    setAdvocateId(returndata.advocateid);

                                            CampaignActionCenter.HideLoaders();

											/*var emailsendbuttoncontent = '<div class="post-left"><i class="fa fa-send"></i></div>';
																emailsendbuttoncontent += '<div class="post-right"> Send Emails';
																emailsendbuttoncontent += ' <i class="fa fa-chevron-right"></i></div>';*/
                                            CampaignActionCenter.email.originalbutton = $('#emailsubmitbutton, .emailsubmitbutton').html();
											getEmailSubmitButtons().html('<i class="fa fa-envelope"></i> Send Emails');
											//$('#emailsubmitbutton, .emailsubmitbutton').html(emailsendbuttoncontent);

											CampaignActionCenter.emailpreviewed = 1;

											var previewdata = new Object;
											previewdata.campaignid = '18755';
											previewdata.advocateid = returndata.advocateid;
											if (returndata.advocate) {
												previewdata.advocate = returndata.advocate;
											}

											// broadcast an event
                							$(document).trigger('widgetFormEvent', {event: 'legEmailSuccess'});

											$.ajax({
												type: 'get',
												url: '/ajax/actioncenter/email/preview',
												dataType: 'html',
												data: previewdata,
												success: function(returndata) {
												    if (!returndata) {
														actionCompleted('email', false);
														showerrormessage('No officials were found for your area. Please check back later.');
														CampaignActionCenter.ShowHiddenInputs();
														CampaignActionCenter.ClearConnectionsRepeatInterval();
														CampaignActionCenter.HideLoaders();
													} else {
                                                        CampaignActionCenter.email.$previewcontainer.html(returndata);
													}

                                                                                                            //Mark action as completed and trigger a click; this will hide the form inputs
                                                        window.numactionscompleted++;
                                                        processCompletedCheckboxes();
                                                        $('#action-email').trigger('click');
                                                    
													// broadcast an event
                									$(document).trigger('widgetFormEvent', {event: 'legEmailPreview'});

													return false;
												}
											});
										}
                                        $('#actioncenterform').trigger('officials-loaded');
									}
								});
			} else {
                var $emailsubmitbuttons = getEmailSubmitButtons();
                $emailsubmitbuttons.html('Sending... <i class="fa fa-spin fa-spinner"></i>').prop('disabled', true);

				formdata.action = 'email';
				if (window.advocateid) {
					formdata.advocateid = window.advocateid;
				}

				if (CampaignActionCenter.email.twostep) {
					formdata.twostep = 1;
				} else {
					formdata.twostep = 0;
				}

				//Contact info and email message is submitted.
				mixpanel.track(mixpanelContactInfoSubmitted.name, mixpanelContactInfoSubmitted.data);
				mixpanel.track(CampaignActionCenter.MixPanel.CreateEventMessage("Email Message Time Elapsed"), CampaignActionCenter.MixPanel.GenerateParams({"action": "email"}));
				//hide any previous errors
				$('#action-container .alert-danger').hide();

				//Set a timeout in case our email call takes a long time - 15 seconds.
				var emailcalltoolong = window.setInterval(function() {
															//Kill the ajax call - the php will still run in the background, but when it returns, it won't do anything to conflict with what we are doing now
															emailcall.abort();
															//Mark this action as completed
															actionCompleted(type);

															window.clearInterval(emailcalltoolong);
															return false;
														}, 15000);

				var emailcall = $.ajax({
									type: 'post',
									url: window.campaignurl,
									dataType: 'json',
									data: formdata,
									success: function(returndata){
										window.clearInterval(emailcalltoolong);

										if (returndata.advocateid) {
											setAdvocateId(returndata.advocateid);
										}

										//If there an is an error message, show it and don't mark action as completed
										if (returndata.error.length) {

                                            $emailsubmitbuttons.html(emailsubmitbuttontext).prop('disabled', false);

											showerrormessage(returndata.error);

											CampaignActionCenter.ShowActionFields('action-email', true);

											// broadcast an event
                							$(document).trigger('widgetFormEvent', {event: 'legEmailError'});

											return false;
										} else if (returndata.success == '1') {
											//Mark this action as completed

											//Email contact to legislators was successful and id's are linked.
											mixpanel.track(CampaignActionCenter.MixPanel.CreateEventMessage("Outbound Contact to Legislator Success"), CampaignActionCenter.MixPanel.GenerateParams({"action": "email"}));



											actionCompleted(type);

                                            CampaignActionCenter.email.actioncompleted = true;

                                            // broadcast an event
                							$(document).trigger('widgetFormEvent', {event: 'legEmailSuccess'});

											return false;
										}
									}
								});
			}
		} else if (type == 'call') {

			//Contact info submitted for phone call.

			//Pass in window.advocateid, pass in the type of call

			mixpanel.track(mixpanelContactInfoSubmitted.name, mixpanelContactInfoSubmitted.data);
			mixpanel.track(CampaignActionCenter.MixPanel.CreateEventMessage("Outbound Contact to Legislator Started"), CampaignActionCenter.MixPanel.GenerateParams({"action": "call"}));
			//mixpanel.track("UX Outbound Contact to Legislator Started", {"action": "call"});
			CampaignActionCenter.HideCookieBadge();
            $('#steptwocontainer .close-dialog').attr('data-action', 'call');
            $('#actioncenterform').trigger('officials-loading');
            var formdata = new Object();

			var formdata = serializeToObject($('#action-container form').serializeArray());

			formdata.action = 'phone';
			formdata.noredirect = 1;
			formdata.obpt = 1;
			formdata.pageloadid = 'JP451HXqYyVkGeQv1518844954.814UnXsp3VEKlVDIBTA';

            
			$('#callsubmitbutton, .callsubmitbutton').hide();
			$('#submitloadingcontainer').show();
			//hide any previous errors
			$('#action-container .alert-danger').hide();

			//Set a timeout incase the phone call takes too long
			var phonecalltoolong = window.setInterval(function() {
														//Kill the ajax call - the php will still run in the background, but when it returns, it won't do anything to conflict with what we are doing now
														phonecall.abort();


																													//Mark this action as completed

															actionCompleted(type);
														
														$('#submitloadingcontainer').hide();

														window.clearInterval(phonecalltoolong);
														return false;
													}, 15000);

			var phonecall = $.ajax({
								type: 'post',
								url: window.campaignurl,
								dataType: 'json',
								data: formdata,
								success: function(returndata){
									window.clearInterval(phonecalltoolong);
									//If there an is an error message, show it and don't mark action as completed
									if (returndata.error.length) {
										$('#callsubmitbutton, .callsubmitbutton').show();
										$('#submitloadingcontainer').hide();

										showerrormessage(returndata.error);

										// broadcast an event
                						$(document).trigger('widgetFormEvent', {event: 'legCallError'});
									} else if (returndata.success == '1') {

										//Phone Contact was successful.
									//	mixpanel.track("UX Outbound Contact to Legislator Success", {"action": "call"});
										mixpanel.track(CampaignActionCenter.MixPanel.CreateEventMessage("Outbound Contact to Legislator Success"), CampaignActionCenter.MixPanel.GenerateParams({"action": "call"}));

										setAdvocateId(returndata.advocateid);

																				    //Set the return data so we can access the view inside actionCompleted
										    CampaignActionCenter.call.returndata = returndata;
											//Mark this action as completed
											actionCompleted(type);
										
										// broadcast an event
                						$(document).trigger('widgetFormEvent', {event: 'legCallSuccess'});
									}
                                    $('#actioncenterform').trigger('officials-loaded');
								}
							});	//End ajax call
		}

		return false;
	});

	$('#actions .action').click(function() {
		var me = this;
		var parentid = $(me).attr('id');

		if ($(me).hasClass('action-completed') === false) {
			activateAction(me);

			//Hide all form elements, except for ones that relate to our action
			var speed = window.actiontransitionspeed;

			var action = '';
			if (parentid == 'action-email') {
				action = 'email';
			} else if (parentid == 'action-facebook') {
				action = 'facebook';
			} else if (parentid == 'action-twitter') {
				action = 'twitter';
			} else if (parentid == 'action-call') {
				action = 'call';
			}

			//First, hide/show specific elements
			if (parentid != 'action-email') {
				$('.email-message').hide(speed);
			} else {
				$('.email-message').show(speed);
			}

			if (parentid == 'action-twitter' && CampaignActionCenter.twitter.$previewcontainer.html().length > 0) {
                CampaignActionCenter.ShowStepTwo('twitter');
			} else {
                CampaignActionCenter.twitter.$previewcontainer.hide(speed);
			}

			if (parentid == 'action-facebook' && CampaignActionCenter.facebook.$previewcontainer.html().length > 0) {
                CampaignActionCenter.ShowStepTwo('facebook');
			} else {
				CampaignActionCenter.facebook.$previewcontainer.hide(speed);
			}
			if (parentid != 'action-twitter' && parentid != 'action-facebook') {
				CampaignActionCenter.ShowCookieBadge();
			} else if (parentid == 'action-twitter') {
				if (CampaignActionCenter.twitter.shownlegs === false) {
					CampaignActionCenter.ShowCookieBadge();
				} else {
					CampaignActionCenter.HideCookieBadge();
				}
			} else if (parentid == 'action-facebook') {
				if (CampaignActionCenter.facebook.shownlegs === false) {
					CampaignActionCenter.ShowCookieBadge();
				} else {
					CampaignActionCenter.HideCookieBadge();
				}
			}




			CampaignActionCenter.ShowActionFields(parentid, false);

			//Now show the correct submit button and explanation of action
			if (parentid == 'action-twitter') {
				mixpanel.track(CampaignActionCenter.MixPanel.CreateEventMessage("Method Chosen Twitter"), CampaignActionCenter.MixPanel.GenerateParams({"action": "twitter", 'campaignID': '18755', 'whenCampaignIDSubmitted': 'before contact info'}));
				//mixpanel.track("UX Method Chosen Twitter", {"action": "twitter"});
				$('.actionsubmitbutton').not('#twittersubmitbutton, .twittersubmitbutton').hide();
				$('#twittersubmitbutton, .twittersubmitbutton').prop('disabled', false).show();

				if (CampaignActionCenter.twitter.$previewcontainer.html().length <= 0) {
					$('#actionexplanation').text( "Tweet at your officials!" );
				} else {
					$('#actionexplanation').text('');
				}
			} else if (parentid == 'action-facebook') {
				mixpanel.track(CampaignActionCenter.MixPanel.CreateEventMessage("Method Chosen Facebook"), CampaignActionCenter.MixPanel.GenerateParams({"action": "facebook", 'campaignID': '18755', 'whenCampaignIDSubmitted': 'before contact info'}));
				//mixpanel.track("UX Method Chosen Facebook", {"action": "facebook"});
				$('.actionsubmitbutton').not('#facebooksubmitbutton, .facebooksubmitbutton').hide();
				$('#facebooksubmitbutton, .facebooksubmitbutton').show();

                if (CampaignActionCenter.facebook.$previewcontainer.html().length <= 0) {
					$('#actionexplanation').text( "Now, you can write a Facebook message supporting the Trump administration actions against catch and release." );
				} else {
					$('#actionexplanation').text('');
				}
			} else if (parentid == 'action-email') {
				$('#actionexplanation').text('');
				mixpanel.track(CampaignActionCenter.MixPanel.CreateEventMessage("Method Chosen Email"), CampaignActionCenter.MixPanel.GenerateParams({"action": "email", 'campaignID': '18755', 'whenCampaignIDSubmitted': 'before contact info'}));
				//mixpanel.track("UX Method Chosen Email", {"action": "email"});
				$('.actionsubmitbutton').not('#emailsubmitbutton, .emailsubmitbutton').hide();
				$('#emailsubmitbutton, .emailsubmitbutton').show();

                if (CampaignActionCenter.email.$previewcontainer.html().length <= 0) {
				    $('#actionexplanation').text( "Send an email to your officials with one click!" );
                } else {
                    $('#actionexplanation').text('');
                }
			} else if (parentid == 'action-call') {
				mixpanel.track(CampaignActionCenter.MixPanel.CreateEventMessage("Method Chosen Call"), CampaignActionCenter.MixPanel.GenerateParams({"action": "call", 'campaignID': '18755', 'whenCampaignIDSubmitted': 'before contact info'}));
				//mixpanel.track("UX Method Chosen Call", {"action": "call"});
				$('.actionsubmitbutton').not('#callsubmitbutton, .callsubmitbutton').hide();

                //setTimeout(function() {
                    $('#callsubmitbutton, .callsubmitbutton').show();
                //}, 50);

				$('#actionexplanation').text( "Enter your phone number to call your officials!" );
			} else if (parentid == 'action-lookup') {
				$('#actionexplanation').text('');

				$('.actionsubmitbutton').not('#lookupsubmitbutton').hide();
				$('#lookupsubmitbutton').show();

				$('#actionexplanation').text( '');
			}

			//Hide the tips and show the tips for our current action
			$('#action-tips-container .action-tip:not([data-action="' + action + '"])').hide();
			$('#action-tips-container .action-tip[data-action="' + action + '"]').show();

			setTimeout(function() {
				$(document).trigger('widgetFormEvent', {event: 'formElementsDisplayChange'});
			}, speed);
		}//End if !action-completed
	});



			//Load the facebook version by default
		$('#action-facebook').trigger('click');
	
	
	window.actiontransitionspeed = 400;

	
		/*	var $bodyscroll = $('body');
		if (typeof $bodyscroll[0] !== 'undefined') {
        	$bodyscroll[0].scrollIntoView();
        }*/
	
	
	
	
	// show the first action
	$('#actions').find('.action:first-child').click();
	});
</script>

<script src="https://d2ab4fmh03vt6m.cloudfront.net/js/helpers/helpers.js?v=1518795536"></script>

    <script>
	/* --- */
	/* Conversion tracking */
	/* --- */
        
     
	

	

</script>
	
    <script type="text/javascript">
                        CampaignActionCenter.emailpreviewed = true;
        
        
        $(function () {
            $('[data-toggle="tooltip"]').tooltip();
        })
    </script>

    <div id="sitecontainer" class="container">
        <div class="row">
                                                    <div id="slider" class="col-md-8">
                <h1 class="heading" id="heading">
                    Let People Know the Trump Administration is Taking Action on Criminal Aliens
                </h1>

                <!-- START MAIN CONTENT -->

                <div class="row" style="overflow:hidden;">
                    <div id="maincontent" class="col-md-12">
                                                    <p>Let's all work together to support President Trump's immigration promises. FAIR laid out our<a href="http://www.fairus.org/publications/immigration-priorities-for-the-2017-presidential-transition" target="_blank">immigration reform blueprint</a> before the election and will monitor the Trump administration's progress.</p>
<p>Promise #3 -Zero Tolerance for Criminal Aliens</p>
<div><img src="https://p2a-images.s3.amazonaws.com/production/customers/565/CampaignMiscImage_1495651922.8033.png" alt="CampaignMiscImage_1495651922.8033.png" /></div>
<p></p>
                                            </div>
                </div>
                <!-- END MAIN COLUMN -->
            </div>

            <div id="action-container" name="actions" class="col-md-4 action-container-default-template">
                <div
    data-p2a-social-share
    data-facebook="true"
    data-facebook-auth="false"
    data-twitter="true"
    data-twitter-auth="false"
    data-domain="p2a.co"
    data-subdomain=""
    data-shorturl="2XxyMpX"
    data-lang="EN"
    data-longurl=""
    data-style=""
  ><!-- populated with JS --></div>
                <div id="heading">
                    <h2>
                        Enter your information to take action now!
                    </h2>
                </div>

                
                <form id="actioncenterform" method="POST" action="/2XxyMpX">
                    <input name="p2asourceid" type="hidden" value="">
                    <input name="domain" type="hidden" value="p2a.co">
                    <input type="hidden" name="_token" value="ZiFT15a8wzxOCjhFGg0xkWMgbTv4xTJSkNZq2pdn">

                     <div id="my_name_hp_wrap" style="display:none;">
<input name="my_name_hp" type="text" value="" id="my_name_hp" aria-label="honeypot name" title="Honeypot Name"/>
<input name="my_time_hp" type="text" value="eyJpdiI6IldoU01JNEVnaDNiWW9kVmF5WG01U0E9PSIsInZhbHVlIjoieExkSzYrNGsrZVZ2aEMxR0trZHdDQT09IiwibWFjIjoiYjEyMzM1ODgwNmE5YTJiOTU4N2ExNjdmZWJlOTY4MmJlOTM2YWFlOGZkZjg2NTJhYWFjNmI0Y2ZhYTczOGNhYyJ9"aria-label="honeypot value" title="Honeypot Name"/>
</div>                     
                    <div id="actions">
                        <div class="row">
                                                            <div style="display: none;">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <div id="action-facebook"
                                                     class="action col-xs-12"
                                                     >
                                            <span class="action-image-container">
                                                <i class="fa fa-facebook fa-3x action-image" tabindex="0" aria-label="Post to Facebook"></i>
                                                <i class="fa fa-check fa-2x green actioncheckmark fa-stack-1x"></i>
                                            </span>
                                                    <div class="action-image-status"></div>
                                                </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                </div>
                                                    </div>
                    </div>

                    <div id="twitterpreviewcontainer"></div>
                    <div id="facebookpreviewcontainer"></div>
                    <div id="emailpreviewcontainer"></div>

                    <div id="action-form"><!--form container-->
                        <canvas id="celebration"></canvas>

                        <div id="actionexplanation"></div>

                        <div class="row form-group">
            <div class="col-sm-12">
                <label class="hidden" for="email">Email (jsmith@email.com)</label>
                <input type="email" class="form-control" name="email" id="email"
                       maxlength="100"
                       placeholder="Email (jsmith@email.com)"
                       value=""
                       data-prettyname="Email Address"
                       data-fieldname="email"
                >
            </div>
        </div>
    
            <div class="row form-group" style="position:relative;">
            <div class="col-sm-12">
                <label class="hidden" for="phone">Mobile Phone</label>
                <input type="tel" class="form-control" name="phone" id="phone"
                       placeholder="Mobile Phone"
                       maxlength="10"
                       style=" width:170px; "
                       value=""
                       data-prettyname="Phone"
                       data-fieldname="phone"
                /><span class="phone-info-icon" data-toggle="tooltip" data-placement="top" title="A phone number is required by most officials&#039; contact forms. If you do not have a mobile number, please use your home phone."><i class="fa fa-question-circle"></i></span>
            </div>
        </div>
    
            <div class="row form-group">
            <div class="col-sm-12">
                <label class="hidden" for="address1">Home Street Address</label>
                <input type="text" class="form-control" name="address1" id="address1"
                       maxlength="100"
                       placeholder="Home Address (123 Any St)"
                       value=""
                       data-prettyname="Street Address"
                       data-fieldname="address1"
                />
            </div>
        </div>
    
            <div class="row form-group">
            <div class="col-sm-12">
                <label class="hidden" for="zip5">Zip Code</label>
                <input type="tel" class="form-control" name="zip5" id="zip5"
                                              maxlength="5"
                                              placeholder="Zip Code"
                       value=""
                       style="width:100px;"
                       data-prettyname="ZIP Code"
                       data-fieldname="zip5"
                >
            </div>
        </div>
    
        <div id="customfieldscontainer">
                    </div><!--end customfieldscontainer-->

                        <div class="form-group">

                        
                        
                                <button class="btn btn-block btn-bright actionsubmitbutton" id="facebooksubmitbutton">
                                    <i class="fa fa-facebook fa-lg action-image"></i> Find Legislators
                                </button>

                        
                        
                        
                            <div id="submitloadingcontainer"><img
                                        src="https://d2ab4fmh03vt6m.cloudfront.net/img/functions/ajax-loader-horizontal-light.gif?v=1518795536"
                                        alt="loading">
                            </div>
                        </div>
                                                
                                            </div><!--end form container-->

                    <div id="action-tips-container">
                        <div class="action-tip" data-action="call">
                                                    </div>
                        <div class="action-tip" data-action="facebook"></div>
                    </div>
                    <div id="completed-container">
                        <div class="row">
  <div id="maincontent" class="col-md-12 text-center">
                <p>Please encourage others to act by sharing on social media.</p>
            
          
          <div
    data-p2a-social-share
    data-facebook="true"
    data-facebook-auth="false"
    data-twitter="true"
    data-twitter-auth="false"
    data-domain="p2a.co"
    data-subdomain=""
    data-shorturl="2XxyMpX"
    data-lang="EN"
    data-longurl=""
    data-style="alt"
  ><!-- populated with JS --></div>
        </div><!--End maincontent-->
</div>
                    </div>

                </form>

            </div>
            <!-- CLOSE ROW -->
        </div>

            <!-- close md-8 -->

    </div> <!-- /container -->

    
        <!-- Modal -->
<div class="modal animated fadeInUp" id="campaignFacebookPreview" tabindex="-1" role="dialog" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
				<span class="modtitle message-subject"></span>
			</div>
			<div class="modal-body">        	
				<div class="row">
					<div class="col-md-10 col-md-offset-1">

						<div class="row">
							<div class="col-sm-12 message-body">
							</div>
						</div>
					</div>  
				</div>      						        	
			</div>
			
			<div class="modal-footer">
				<button class="btn btn-success" id="btnCampaignFacebookPreview" data-dismiss="modal">Close &amp; Take Action Now</button>
			</div>		
		</div><!-- /.modal-content -->
	</div><!-- /.modal-dialog -->
</div><!-- /.modal -->    <!-- Modal -->
<div class="modal animated fadeInUp" id="campaignFacebookExplainPermissions" tabindex="-1" role="dialog" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
				<span class="modtitle message-subject"></span>
			</div>
			<div class="modal-body">        	
				<div class="row">
					<div class="col-md-10 col-md-offset-1">

						<div class="row">
							<div class="col-sm-12 message-body">
							</div>
						</div>
					</div>  
				</div>      						        	
			</div>
			
			<div class="modal-footer">
				<button class="post-button" id="facebookdeniedpermissionsubmitbutton">
					<div class="post-left"><i class="fa fa-facebook-square"></i></div>
					<div class="post-right">Post Now <i class="fa fa-chevron-right"></i></div>
				</button>
				<button class="btn btn-success" id="btnCampaignFacebookPreview" data-dismiss="modal">Close & Take A Different Action</button>
			</div>		
		</div><!-- /.modal-content -->
	</div><!-- /.modal-dialog -->
</div><!-- /.modal -->
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://d2ab4fmh03vt6m.cloudfront.net/js/apps/bootstrap.js?v=1518795536"></script>

    <script src="https://d2ab4fmh03vt6m.cloudfront.net/js/apps/carousel.js?v=1518795536"></script>


    <script>
	window.lasttrigger = '';
	
	$(function() {
		$('.customfield').change(function() {
			getChildren(this);
		});
	});
	
		
	
	
	function getChildren(element)
	{
		var value = $(element).val();
		var fieldid = $(element).attr('fieldid');
		
				
		if(fieldid && value){
			
			formdata = new Object();
			
			var checkedvalues = new Array();
			$('[fieldid="' + fieldid + '"]').each(function(index, value) {				
				if (
					($(this).attr('type') == 'checkbox' || $(this).attr('type') == 'radio') && $(this).is(":checked")
					||
					($(this).attr('type') != 'checkbox' && $(this).attr('type') != 'radio')
					) {
					checkedvalues.push($(this).val());
				}
			});
			formdata.checkedvalues = checkedvalues;
			
						
			$.ajax({
				type: "GET",
				data: formdata,
				url: "/ajax/fields/children/" + fieldid + "/" + value,
				success: function(data){
					var customqcontainer = $('div[data-parentfieldid="' + fieldid + '"]');
					if (customqcontainer != null && customqcontainer.length) {
						customqcontainer.html(data);
					} else {
						var newquestioncode = '<div data-parentfieldid="' + fieldid + '">' + data + '</div>';
						$(element).parent().parent().append(newquestioncode);
					}	
				}
			})
			
		}
		
	}

</script>
    

  <script src="https://d2ab4fmh03vt6m.cloudfront.net/js/social/share.js?v=1518795536"></script>


  <meta name="csrf-token" content="ZiFT15a8wzxOCjhFGg0xkWMgbTv4xTJSkNZq2pdn">
  <script type="text/javascript">
	  $.ajaxSetup({
		  headers: {
			  'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
		  }
	  });
  </script>

  <script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","licenseKey":"4b097c870f","applicationID":"21577045","transactionName":"YVIEYEdSDEcCBkENVlgYJ1dBWg1aTCRFFGV+QxJEaXANWhcXWghVU0UVaHRDEncMC0EWVlpbA0Z1VAdAIhVF","queueTime":0,"applicationTime":149,"atts":"TRUHFg9IH0k=","errorBeacon":"bam.nr-data.net","agent":""}</script></body>
</html>
